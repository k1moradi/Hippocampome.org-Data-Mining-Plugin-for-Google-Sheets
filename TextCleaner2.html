<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
function highlightElem(elem){
  elem.innerHTML = elem.innerHTML
    .replace(/\b(epilep(?:ticus|tic|sy|sia)|seisure[s]*|field|culture|a.actinin)\b/ig,
      "<mark style='background-color:red;color:white;'>$1</mark>") //red    exclude this paper
    .replace(/(\d(?:[\‚Äì '&]| \.|.\ | \. )\d| \w \w |p[Mm]|¬µm|\bmm,?\b|[\x01\x02\x03\x04\x05\x06\x07\x08ÔÅ°ÔÅ¢])/g, 
      "<mark style='background-color:hotpink;'>$1</mark>")          //tomato unautomatable mistakes
}
function formatText(elem) {
  removeUnwantedNodes(elem);
  elem.innerHTML = elem.innerHTML
    .replace(/[¬¨-][\r\n]+|^\s+|(?<=~)\s(?=\d)|(?<=\d[ ‚Äì-]m)\s+(?=s[ );,.])|(?<=\d)\s+(?=%)|(?<= o) (?=f[ ‚Äì])/g   , '')
    .replace(/(?<=[(;, ])([Ff]) *i *g *(s)? *\.(?=[ ),;.])/g                                                     , '$1ig$2.') // Fi g. --> Fig.
    .replace(/(?<=[(;, ]R) *(M) *(?=P[ ),;.])/gi                                                                 , '$1') // R M P --> RMP
    .replace(/(?<!<br>)[\r\n]+|[\t\s]+|&nbsp;|&thinsp;|(?<=tables|table|figures|figure|figs\.|fig\.|figs|fig)(?=\w\w?[ \.\?;,)])(?!s[\. ]?)|(?<=[,;])(?=n=\d)|(?<= of)(?=‚Äì\d+)/ig, ' ')
    .replace(/(?<=(?:tables|table|figures|figure|figs\.|fig\.|figs|fig) \w) (?=\w[ ])/ig                         , '')
    .replace(/&ndash;/g, '‚Äî').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&amp;/g,'&').replace('‚ó¶','¬∞')
    .replace(/(?<=[(;, ])([Tt])ruce(s)?(?=[ ),;.])/g                                                             , '$1race$2')
    .replace(/([iI])n *t *e *r? *[mn] *e *u *r *o *n(s*)/g                                                       , '$1nterneuron$2')
    .replace(/(?<=[(;, ])(Na|Cs|K|N)H *[2z,*] *P *[O0] *[4,](?=[ ),;.])/g                                        , '$1H‚ÇÇPO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *HP[O0] *4(?=[ ),;.])/g                                                , '$1‚ÇÇHPO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K)CH *3 *S *[O0] *4(?=[ ),;.])/g                                                 , '$1CH‚ÇÉSO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *[-‚Äî‚Äì] *[Pp]hosphocreatine(?=[ ),;.])/g                                , '$1‚ÇÇ-phosphocreatine')
    .replace(/(?<=[(;, ])(Na|Cs|K)H *C *[O0] *[3,](?=[ ),;.])/g                                                  , '$1HCO‚ÇÉ')
    .replace(/(?<=[(;, ])(Na|Cs|K) *3 *GTP(?=[ ),;.])/g                                                          , '$1‚ÇÉGTP')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *(G|A)TP(?=[ ),;.])/g                                                  , '$1‚ÇÇ$2TP')
    .replace(/(?<=[(;, ])(Ca|Mg|Ni|Co|Sr) *C[lI1] *[2z,](?=[ \/),;.])/g                                          , '$1Cl‚ÇÇ')  // 1I as l
    .replace(/(?<=[(;, ])(H|Na|Cs|K) *C[I1](?=[ ),;.])/g                                                         , '$1Cl')   // 1I as l
    .replace(/(?<=[(;, ])M *gS[O0] *4(?=[ ),;.])/g                                                               , 'MgSO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K)MeS[O0] *3(?=[ ),;.])/g                                                        , '$1MeSO‚ÇÉ')//Methylsulfonate = Methanesulfonate
    .replace(/(?<=[(;, ])(Na|Cs|K)MeS[O0] *4(?=[ ),;.])/g                                                        , '$1MeSO‚ÇÑ')//Methylsulfate
    .replace(/(?<=[(;, ]|\.|\.\d)H *[2z,] *[O0](?=[ ),;.])/g                                                     , 'H‚ÇÇO')
    .replace(/(?<=[(;, \/])C *[O0] *[2z,?](?=[ ),;.])/g                                                          , 'CO‚ÇÇ')
    .replace(/(?<=[(;, ])[O0] *2(?=[ +\/),;.‚Äì\-])/g                                                              , 'O‚ÇÇ')
    .replace(/(?<=[\[(\/;, ‚Äì-])Cl\s*[-‚àí"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ ‚Äì),;.\]])/g                        , 'Cl‚Åª')
    .replace(/(?<=[\[(\/;, ‚Äì-])(Na|K|Cs)\s*[+'"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ -‚Äì),;.\]])/g                , '$1‚Å∫')
    .replace(/(?<=[\[(\/;, ‚Äì-])(Mg|Ca|Sr)\s*[2\*]\s*[+'"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ -‚Äì),;.\]])/g       , '$1¬≤‚Å∫')
    .replace(/\[\s*(Cl‚Åª|Cs‚Å∫|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\s*\]/g                                                             , '[$1]')    //[ Ca¬≤‚Å∫ ] -> [Ca¬≤‚Å∫]
    .replace(/(?<=[(;, ])\[(Cl‚Åª|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\]\s*[iI1](?=[ ),;.])/g                                         , '[$1]·µ¢')
    .replace(/(?<=[(;, ])\[(Cl‚Åª|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\]\s*[oO0](?=[ ),;.])/g                                         , '[$1]‚Çí')
    .replace(/(?<=[(;, ])\[(Cl‚Åª|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\]\s*[E](?=[ ),;.])/g                                           , '[$1]<sub>E</sub>')
    .replace(/(?<=[(;, ])et\s*a[1!]\.(?=[ ),;.])/g                                                               , 'et al.')
    .replace(/(?<=[(;, ])C *A\s*[lI](?=[ ),;.])/g                                                                , 'CA1')     // lI as 1
    .replace(/(?<=[(;, ])C *A *([1-4])(?=[ ),;.])/g                                                              , 'CA$1')    // C A 1 --> CA1
    .replace(/(?<=[(;, ])([Ff]igs*|FIGS*)(\.*) *[lI]([A-Za-z]{0,2})(?=[ ),;.])/g                                 , '$1$2 1$3')// lI as 1
    .replace(/(?<=[(;,=><~‚â§‚â• ])(\d*)\s*[lI]\s*(\d+[.]\d+|\d+)(?<![(;,=><~‚â§‚â• ]I\d)(?=[ ),;.])/g                   , '$11$2')   // lI as 1
    .replace(/([(;, ].{1,3}[=><~‚â§‚â•])\s*(\d+\.\d+|\d+)\s*[lI]\s*(?=\d*[ ,;.)])/g                                  , '$1$21')   // lI as 1
    .replace(/(?<=[(;, ])(GABA)[-‚Äî‚Äì_ ]*[Aa](?=\s*-*\s*receptor|[ ),;.])/g                                        , '$1-A')    // GABA-A
    .replace(/(?<=[(;, ])(GABA)[-‚Äî‚Äì_ ]*[8B](?=\s*-*\s*receptor|[ ),;.])/g                                        , '$1-B')    // GABA-B
    .replace(/(?<=[(;, ])[od][-‚Äî‚Äì_ ]AP(V|5)(?=[ ),;.])/g                                                         , 'D-AP$1')
    .replace(/(?<=[(\/\d])(\s*mM\s*)?QX\s*[-‚Äì]?314(?=[ ),;.])/g                                                  , '$1QX314')
    .replace(/(?<=\d\s)mm(?=\s*(?:(?:Na{0,1}|C[als]|K|Mg|potassium|sodium|calcium|cesium|disodium)(?:¬≤‚Å∫|‚Å∫|‚Åª|(?:‚ÇÇH|H‚ÇÇ)PO‚ÇÑ|(?:CH‚ÇÉ|Me)*SO[‚ÇÉ‚ÇÑ]|[- ](?:phosphocreatine|gluconate)|HCO‚ÇÉ|[‚ÇÉ‚ÇÇ]*[GA]TP|Cl‚ÇÇ*|OH){0,1}[ ,;\/.)]|EGTA|[GA]TP|HEPES|QX.{0,1}314|TEA|glucose))|(?<=[(;, ]in )mm(?=[ ),;.])|(?<=QX‚Äì314 \(\d+ )mm(?=\))/g
                                                                                                                 , 'mM')
    .replace(/(?<=[(;, ])m M(?=[ ),;.])/g                                                                        , 'mM')
    .replace(/(?<=[(\d])\s*(?:mY|m V|mV)(?=[ ),;.])/g                                                            , ' mV')
    .replace(/(\d+(?:\.\d+){0,1})([^<>)(\d]{0,1})(?:[Uut]|\/[ux]|[mg]u|I[Lt]|J\.*L|JI|F[Li]{0,1}|\/[jt\/\^]|j[f<iu]|[\/\(]i|i[xj]|p[\.Rut]|[!tl]J\.|[-~]t|,u[\.]{0,1}|#¬£|\|x|[g√¨\x01\x02\x03\x04\x05ÔÅ≠\^])\s*([MmsA]|m2|[Ss]ec)(?=[ ),;.‚Äì]|.thick)/g,
      function(fullMatch,p1,p2,p3){
        return p1+((p2)?p2:' ')+'¬µ'+((p3 === 'm2')?'m¬≤':p3)})                                                               //¬µM
    .replace(/(?<=[(\d])\s*(?:[pP]|\|x)(M)(?=[ ),;.])/g                                                          , ' ¬µ$1')  //¬µM ¬µV not PV+
    .replace(/\|/g                                                                                               , 'I')
    .replace(/(?<=[(\d])\s*[\x01\x02\x03\x04\x05]\s*([tT])(?=[ ),;.])/g                                          , ' Œî$1')
    .replace(/(?<=[(\d])\s*([GM])\s*(?:[√ôQ\x01\x02\x03\x04\x05\x06\x07ÔÅó]|[Oo]mega|S2|t2|IL|12)(?=[ ),;.])/g      , ' $1Œ©')
    .replace(/(?<=\d)\s√í/g                                                                                       , ' M')
    .replace(/(?<=[\(\s])CV\s*[\x01\x02\x03\x04\x05\x06\x07-‚àí]\s*2(?=[\s\)])/g                                  , 'CV‚Åª¬≤')
    .replace(/(?<=\s)1[\/]CV 2(?=\s)/g                                                                           , '1/CV¬≤')
    .replace(/(?<=\d)\s*mm\s*2(?=[\s,])/g                                                                        , ' mm¬≤')
    .replace(/(?<=\s)((?:mS[\s¬∑])?[cm]m)\s*[\-‚Äì]\s*2(?=[\s,])/g                                                  , '$1‚Åª¬≤')
    .replace(/(?<=\d)\s*o\/o(?=[ ),;.])/g                                                                        , '%')
    .replace(/(?<=[\s¬∑])(min|m‚ãÖ?[gsL]|[¬µc]m)\s*[-‚Äì]\s*1(?=[\s)])/g                                                , '$1‚Åª¬π')
    .replace(/w√èv/g                                                                                              , 'w/v')
    .replace(/Ô¨Å/g                                                                                                , 'fi')
    .replace(/Greek Letter Mu|&micro;\s*|Œº|&mu;/g                                                                , '¬µ')   //ALT+230 convert unicode to ascii
    .replace(/(?:\\tau|&tau;|(?<= )tau(?= )|tau(?= *=)|((?:time constants*|decay|rise) *\(*)tau\)*)/ig           , '$1œÑ') //ALT+231
    .replace(/omega([^<>)(]{0,1}(?:aga|cono)toxin)/g                                                             , 'œâ$1')
    .replace(/(?<=\d)\s*[¬∑*]\s*(?=\d)|(?<=[ ¬±+‚Äì]0)‚Äì?(?=(?:0\d+|[1-9])[ ¬±+])/g                                    , '.')   // decimal point  |(?<=[ +=]\d)[‚Äì'](?=\d+[ +])
    .replace(/(?<=[ =,;(]\d+)[‚Äì'&.](\d+)\s*([+¬±‚Äì])\s*(\d+)[‚Äì'&.](?=\d+[ ),;])/g                                  , '.$1$2$3.') //\d‚Äì\d‚Äì\d‚Äì\d --> \d.\d‚Äì\d.\d)
    .replace(/(?<=[A-Za-z])\s*[-‚àí](\s*)(?=[A-Za-z])/g                                                            , '-$1') // negative as hiphen between two words
    .replace(/(?<=[\w¬π¬≤¬≥‚ÇÇ‚ÇÉ‚ÇÑ‚Å∫‚ÅªŒ±√ü¬µœÑŒîŒ©Œ≥])[‚Äì‚Äî‚àí-](?=[\w¬π¬≤¬≥‚ÇÇ‚ÇÉ‚ÇÑ‚Å∫‚ÅªŒ±√ü¬µœÑŒîŒ©Œ≥])/g                                             , '‚Äì')   // normal hiphen as big hiphen or negative signs between two words
    .replace(/&minus;|(?<= [‚àº(]) *[‚Äì‚Äî‚àí](?=\d)/g                                                                   , '-')   // ngative
    .replace(/(?<=[\d])\s*(?:[‚Äì‚Äî‚àí]|&ndash;)\s*(\d+)\s*(?=%)/g                                                    , '-$1') // 20-80%
    .replace(/(?<=[(;, ])[I1]‚Äì0(?=[ ),;.])/g                                                                     , 'I-O')
    .replace(/(?<=[(;, ])[n¬´]\s*(?:[\x01\x02\x03\x04\x05\x06\x07\x08]*| -|=)\s*(?=\d+[ ),;.])/g                  , 'n=')
    .replace(/(?<=[(;, ])([pP])\s*[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=0*\.0(5|1|01)[ ),;.])/g                , '$1<')
    .replace(/(?<=[(;, ])([pP])\s*[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?!0*\.0(5|1|01))(?=0*\.0\d+[ ),;.])/g    , '$1=')
    .replace(/(?<=\<\/sub>)\s*[\x01\x02\x03\x04\x05\x06\x07\x08](?=[ ),;.])/g                                    , '=')
    .replace(/plusminus|&plusmn;/g                                                                               , '¬±')
    .replace(/(?<=[(;, >=])([\-‚àí+]{0,1}\d+(?:\.\d+){0,1})(?<!55845|95531|314|222)\s*(.{0,1}Œ©|[¬µŒº].{0,1}|¬∞C|m[MVs]|m[lL].{0,1}min|[pn][ASF]|Hz|%)*\s*(?:[¬±+\x01\x02\x03\x04\x05\x06\x07\xAD])\s*(?=\d+(?:\.\d+){0,1}[ )%,;¬∞.<])/g
                                                                                                                 , '$1$2¬±')//\d ¬± \d    --> \d¬±\d
    .replace(/(?<=[(;, \]\/])([Mm]eans{0,1}|MEANS{0,1})\s*(?:[¬±+\x01\x02\x03\x04\x05\x06\x07\xAD])\s*(?=[Ss]\.{0,1}[EeDd]\.{0,1}[Mm]{0,1})/g
                                                                                                                 , '$1¬±') // Mean ¬± SEM --> Mean¬±SEM
    .replace(/(?<=[A-Za-z=,(])(\s*)[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=[5-8][05][ ),;.])/g                   , '$1-') // control character as negative sign for values <-50
    .replace(/(?<=[A-Za-z=,(])(\s*)[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=\d+[¬±.]\d+[ ),;.¬±])/g                 , '$1-') // control character as negative sign between a word and a number with decimals
    .replace(/(?<=[=><(‚â§‚â•~ ])(\s*)[‚Äì‚Äî‚àí]\s*(?=(?:\d+[.]\d+|\d+)[ ),;.¬±])/g                                        , '$1-') // hiphen as negative sign
    .replace(/(?<=\w[(;, ])(\s*[~+\-><‚âà])\s(?=(?:\d+[.]\d+|\d+)[ ),;.¬±])/g                                       , '$1')  // [~+-><]\s\d
    .replace(/approx(?=\d)/g                                                                                     , '~')
    .replace(/(?<=\w)\s*[(]\s(?=-{0,1}[\wŒî¬µ])/g                                                                  , ' (')
    .replace(/(?<=[\w\dŒ©])\s[)]\s*(?=[:.,;])/g                                                                   , ')')
    .replace(/(?<=[\w\dŒ©%])\s*[)]\s*(?=[\w])/g                                                                   , ') ')
    .replace(/(?<=[\w¬π¬≤‚ÇÇ‚ÇÉ‚ÇÑŒ©])\s*([,;%])\s*(?=[A-Za-z])/g                                                         , '$1 ') // space after ,;%
    .replace(/\s*(?:=<(?!(?:sub|s|i|b|br|em|div|strong)>)|<=)\s*/g                                               , '‚â§')
    .replace(/(?<=sub|s|i|b|em|br|div|strong)(?!>=)> *= *(?=\d)/g                                                , '>=')
    .replace(/\s*(?:=>|>=(?<!sub>=|s>=|i>=|b>=|em>=|br>=|div>=|strong>=))\s*/g                                   , '‚â•')
    .replace(/-->/g                                                                                              , '‚ûû')
    .replace(/<--/g                                                                                              , '‚¨Ö')
    .replace(/<->/g                                                                                              , '‚¨å')
    .replace(/^[ .?!)}]]+(?=\w)|\xAD/g                                                                           , '')
    .replace(/(?<!\..)(?<=[\w‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Çô‚Çò‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ)])\s*\.\s*(?=[a-zA-z]+\s)/g                                     , '. ')
    .replace(/\s*\.+\s*$/g                                                                                       , '.')
    .replace(/(?<=[(;, ])V *(amp|hold(?:ing)?|thresh*)(?=[ =),;.])/ig                                            , 'ùëâ<sub>$1</sub>')
    .replace(/(?<=[(;, ])(?:[trœÑ]|tau) *(D|d|R|decay|rise)(?=[ =),;.])/g                                         , 'œÑ<sub>$1</sub>')
    .replace(/(?<=[(;, ‚Äì])([EI]) *(K|Na|C[lsa]|rev|GABA)(?=[ =),;.])/g                                           , '$1<sub>$2</sub>')
    .replace(/(?<=[(;, ])R *([Ss]|in|IN)(?=[ =),;.])/g                                                           , 'R<sub>$1</sub>')
    .replace(/(?<=[A-Za-z]{3}|[)])\s*(\d+(?:,\s*\d+)+)(?=\s\(|[.,]\s|\.$)/g                                      , '<sup>$1</sup>') // numerical references
    .replace(/(?:((?<=[(;, ])(?:ms|min|sec|¬µm|œá)|\^)([-‚Äì‚àí]*\s*\d+(?:\.\d+)*(?!‚Äì))|(?<!alexa|prox|and|was|[Tt]able|[Ff]igure|paradigm|cell|neuron|actinin|GAD)(?<=[a-z]{3}|[)])\s*([\d‚Äì]{1,3})(?=\.(?:\s|<br>)|\.$))/g, 
      function(fullMatch,p1,p2,p3){
        var prefix = ((p1 === '^' || !p1) ? '' : p1)
        var num = Array.from((p2)?p2:p3).reduce(
          function(num,digit){
            switch (digit) {
              case "0": return num+'‚Å∞'; break;
              case "1": return num+'¬π'; break;
              case "2": return num+'¬≤'; break;
              case "3": return num+'¬≥'; break;
              case "4": return num+'‚Å¥'; break;
              case "5": return num+'‚Åµ'; break;
              case "6": return num+'‚Å∂'; break;
              case "7": return num+'‚Å∑'; break;
              case "8": return num+'‚Å∏'; break;
              case "9": return num+'‚Åπ'; break;
              case "-": return num+'‚Åª'; break;
              case "‚Äì": return num+'‚Åª'; break;
              case "‚àí": return num+'‚Åª'; break;
              case ".": return num+'‚ãÖ'; break;
              default : return num; break;
          }
        },'');
        return prefix+num
      })                                                                                                                        //¬µm¬≤
    .replace(/((?<=[\/(;, ])[vcrœÑ]|[esmu]{0,1}\.{0,1}[ei]\.{0,1}p\.{0,1}s\.{0,1}[cp]|_)(\d+|\s\d|\s*[nmhi])(?<!c57|CI|RI)(?=[ =\/),;.+](?!ANOVA)|\s*<\/)/ig, //RI = Resistance Internal != Rectification Index
      function(fullMatch,p1,p2){
        var prefix = ((p1 === '_') ? '' : p1);
        var num = Array.from(p2).reduce(
          function(num,digit){
            switch (digit) {
              case "0": return num+'‚ÇÄ'; break;
              case "1": return num+'‚ÇÅ'; break;
              case "2": return num+'‚ÇÇ'; break;
              case "3": return num+'‚ÇÉ'; break;
              case "4": return num+'‚ÇÑ'; break;
              case "5": return num+'‚ÇÖ'; break;
              case "6": return num+'‚ÇÜ'; break;
              case "7": return num+'‚Çá'; break;
              case "8": return num+'‚Çà'; break;
              case "9": return num+'‚Çâ'; break;
              case "n": return num+'‚Çô'; break;
              case "N": return num+'<sub>N</sub>'; break;
              case "m": return num+'‚Çò'; break;
              case "M": return num+'<sub>M</sub>'; break;
              case "h": return num+'‚Çï'; break;
              case "H": return num+'<sub>H</sub>'; break;
              case "i": return num+'·µ¢'; break;
              case "I": return num+'<sub>I</sub>'; break;
              default : return num; break;  // removes space
            }
          },'')
        return prefix+num
      })  //œÑ‚ÇÅ PSC‚ÇÅ
    .replace(/(?<=[(;, ])(\w+(?:<su[bp]>\w+<\/su[bp]>|[‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ‚Çï·µ¢‚Çò‚Çô‚Çí])*(?:[:\/\+\-]\w+(?:<su[bp]>\w+<\/su[bp]>|[‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ‚Çï·µ¢‚Çò‚Çô‚Çí])*)*|\[\w\w¬≤{0,1}[‚Åª‚Å∫]\][·µ¢‚Çí]{0,1})\s([><¬±‚â§‚â•])\s*(?=[-+]{0,1}\d)/g
                                                                                                                 ,'$1 $2') //[><‚â§‚â•¬±] \d --> [><‚â§‚â•¬±]\d //[^aI ]|[^awhumboie ][^lenyfptio ]|sub>
    .replace(/(PV|CB1{0,1}|CR|CCK|SOM|VIP)\s([+-])/g                                                             , '$1$2') // PV +/CCK + BC --> PV+/CCK+ BC, 
    .replace(/(?<=[(;, \]\/])(sub>|[Œ±√üŒ≥Œ¥ŒµŒ∂Œ∑Œ∏ŒªŒ∫Œ∂Œæ¬µœÅœÑœÄœÜœáœàœâœÉ‚àÜŒ©\w‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ‚Çï·µ¢‚Çò‚Çô]+)\s*([=])\s*(?=[-+]{0,1}\d)/g , '$1$2') // word = \d --> word=\d
    .replace(/(?<=[(;, \]\/])(p|P)\s*([<>‚â§‚â•])\s*(?=-{0,1}\d)/g                                                   , '$1$2') // p < \d --> p<\d
    .replace(/\s+\<(br|\/td)>/g                                                                                  , '<$1>')
    .replace(/(^[\-‚Äì \w]{1,100}? )([Aa](?: and [Bb]){0,1},)(?= )/                                                ,'<b>$1</b><br>$2')
    .replace(/(<br>\s*|(?<![Ff]igs|[Ff]ig|refs|ref|vs|et ?al)\.\s)(?![Ww]e|\(\w[a-z0-9]?,)(\(?\w[a-z0-9]?(?: ?[,‚Äì\-] ?\w[a-z0-9]{0,1}|,{0,1} (?:and|to) \w[a-z0-9]{0,1}){0,1}[\),:]|\w[a-z0-9]{0,1}[\.,:])(?<!ml,)(?= )/g, 
      function(fullMatch,p1,p2){
        return ((p1==='. ')?'.':'')+'<br><b>'+p2+'</b>'
      })                                                                                                                        // a-b, bold image list
    .replace(/(?<=[\.;]|<\/b>|<br>)\s*((?:(?:right|left|top|bottom|middle|center|inset)\s*(?:panel|trace)?,(?=\s*))+)/ig, ' <b>$1</b>') // bold subsections in figures
    .replace(/^([^.,?]+\.)\s*(?=<br>)/g                                                                          , '<b>$1</b>') // bold the 1st sentence
    .replace(/(?:[\n\s]*(?:<br>)+(?!\n)|(?:<br>)+\n+)/g                                                          , '<br>')
    .replace(/<\/b>\s*<b>/g                                                                                      , ' ')
    .replace(/ *> +< */g                                                                                         , '><')
    //.replace(/<p>/g                                                                                              , '&lt;p&gt;')
    .replace(/(\d)\s*\/\s*(\d)(?<!\d\/\d)/g                                                                      ,'$1/$2'); //remove space between numbers and /
    highlightElem(elem);
};
    </script>
    <style>
      .textCleanerDiv {
        width: calc(100vw - 0px);
        height: calc(100vh - 26px);
        padding: 1px;
        font-family: 'Open Sans', sans-serif;
        font-size: 14px;
        //letter-spacing: 1px;
        line-height: 1.5em;
        display: block;
        position: absolute;
        margin: 0;
        border: 2px solid #74637f;
        border-radius: 0;
        color: black;
        background-color: white;
        overflow: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      .textCleanerDiv br {
        line-height:200%;
      }
      .textCleanerDiv sup {
        font-size: 58%;
        font-weight: bold;
        vertical-align: 20%;
      }
    </style>
    <?!=include('commonCSS')?>
  </head>
  <body>
    <title>PDF Text Cleaner Tool</title>
    <input type='button' class='button' value='ùóï'  onmousedown="document.execCommand('bold', false, null)"   title='Ctrl+B'>
    <input type='button' class='button' value='ùë∞'  onmousedown="document.execCommand('italic', false, null)" title='Ctrl+I'>
    <input type='button' class='button' value='ùêí'  onmousedown="document.execCommand('strikeThrough', false, null)" style='text-decoration: line-through;'>
    <input type='button' class='button' value='ùëø‚ÇÇ' onmousedown="document.execCommand('subscript', false, null)">
    <input type='button' class='button' value='ùëø¬≤' onmousedown="document.execCommand('superscript', false, null)">
    <input type='button' class='button' value='‚åÇ'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().replace(/ /g, ''))" title='remove all spaces'>
    <input type='button' class='button' value='üÜÑ'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().toUpperCase());" title='to UpperCase'>
    <input type='button' class='button' value='üÖª'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().toLowerCase());" title='to LowerCase'>
    <div class="dropdown">
      <input   type='button' class='button' value='üî£'>
      <div class="dropdown-content">
        <input type='button' class='button' value='¬∞'  onmousedown="document.execCommand('insertText', false, '¬∞')"   title='degree'>
        <input type='button' class='button' value='¬±'  onmousedown="document.execCommand('insertText', false, '¬±')"   title='plus minus'>
        <input type='button' class='button' value='√ó'  onmousedown="document.execCommand('insertText', false, '√ó')"   title='multiply'>
        <input type='button' class='button' value='‚àö'  onmousedown="document.execCommand('insertText', false, '‚àö')"   title='root square'>
        <input type='button' class='button' value='‚àë'  onmousedown="document.execCommand('insertText', false, '‚àë')"   title='Zigma'>
        <input type='button' class='button' value='‚âà'  onmousedown="document.execCommand('insertText', false, '‚âà')"   title='almost equal to'>
        <br>
        <input type='button' class='button' value='Œ±'  onmousedown="document.execCommand('insertText', false, 'Œ±')"   title='alpha'>
        <input type='button' class='button' value='√ü'  onmousedown="document.execCommand('insertText', false, '√ü')"   title='beta'>
        <input type='button' class='button' value='Œ≥'  onmousedown="document.execCommand('insertText', false, 'Œ≥')"   title='gamma'>
        <input type='button' class='button' value='Œ¥'  onmousedown="document.execCommand('insertText', false, 'Œ¥')"   title='delta'>
        <input type='button' class='button' value='Œµ'  onmousedown="document.execCommand('insertText', false, 'Œµ')"   title='epsilon'>
        <input type='button' class='button' value='Œ∂'  onmousedown="document.execCommand('insertText', false, 'Œ∂')"   title='zeta'>
        <input type='button' class='button' value='Œ∑'  onmousedown="document.execCommand('insertText', false, 'Œ∑')"   title='eta'>
        <input type='button' class='button' value='Œ∏'  onmousedown="document.execCommand('insertText', false, 'Œ∏')"   title='theta'>
        <input type='button' class='button' value='Œª'  onmousedown="document.execCommand('insertText', false, 'Œª')"   title='lamda'>
        <input type='button' class='button' value='Œ∫'  onmousedown="document.execCommand('insertText', false, 'Œ∫')"   title='kappa'>
        <input type='button' class='button' value='Œ∂'  onmousedown="document.execCommand('insertText', false, 'Œ∂')"   title='zeta'>
        <input type='button' class='button' value='Œæ'  onmousedown="document.execCommand('insertText', false, 'Œæ')"   title='xi'>
        <input type='button' class='button' value='¬µ'  onmousedown="document.execCommand('insertText', false, '¬µ')"   title='mu, shortcut:Ctrl+M'>
        <input type='button' class='button' value='œÅ'  onmousedown="document.execCommand('insertText', false, 'œÅ')"   title='rho'>
        <input type='button' class='button' value='œÑ'  onmousedown="document.execCommand('insertText', false, 'œÑ')"   title='tau'>
        <input type='button' class='button' value='œÄ'  onmousedown="document.execCommand('insertText', false, 'œÄ')"   title='pi'>
        <input type='button' class='button' value='œÜ'  onmousedown="document.execCommand('insertText', false, 'œÜ')"   title='phi'>
        <input type='button' class='button' value='œá'  onmousedown="document.execCommand('insertText', false, 'œá')"   title='chi'>
        <input type='button' class='button' value='Œ¶'  onmousedown="document.execCommand('insertText', false, 'Œ¶')"   title='Phi'>
        <input type='button' class='button' value='œà'  onmousedown="document.execCommand('insertText', false, 'œà')"   title='Psi'>
        <input type='button' class='button' value='œâ'  onmousedown="document.execCommand('insertText', false, 'œâ')"   title='Omega'>
        <input type='button' class='button' value='œÉ'  onmousedown="document.execCommand('insertText', false, 'œÉ')"   title='Sigma'>
        <input type='button' class='button' value='Œî'  onmousedown="document.execCommand('insertText', false, 'Œî')"   title='Delta'>
        <input type='button' class='button' value='Œ©'  onmousedown="document.execCommand('insertText', false, 'Œ©')"   title='Omega'>
        <br>
        <input type='button' class='button' value='‚óÄ'  onmousedown="document.execCommand('insertText', false, '‚óÄ')"  title='Backward triangle'>
        <input type='button' class='button' value='‚ñ≤'  onmousedown="document.execCommand('insertText', false, '‚ñ≤')"   title='up triangle'>
        <input type='button' class='button' value='‚ñº'  onmousedown="document.execCommand('insertText', false, '‚ñº')"   title='down triangle'>
        <input type='button' class='button' value='‚ñ∂'  onmousedown="document.execCommand('insertText', false, '‚ñ∂')"  title='Forward triangle'>
        <input type='button' class='button' value='‚óÅ'  onmousedown="document.execCommand('insertText', false, '‚óÅ')"  title='Backward triangle'>
        <input type='button' class='button' value='‚ñ≥'  onmousedown="document.execCommand('insertText', false, '‚ñ≥')"  title='up triangle'>
        <input type='button' class='button' value='‚ñΩ'  onmousedown="document.execCommand('insertText', false, '‚ñΩ')"  title='down triangle'>
        <input type='button' class='button' value='‚ñ∑'  onmousedown="document.execCommand('insertText', false, '‚ñ∑')"  title='Forward triangle'>
        <br>
        <input type='button' class='button' value='‚¨Ö'  onmousedown="document.execCommand('insertText', false, '‚¨Ö')">
        <input type='button' class='button' value='‚¨å'  onmousedown="document.execCommand('insertText', false, '‚¨å')">
        <input type='button' class='button' value='‚ûû'  onmousedown="document.execCommand('insertText', false, '‚ûû')">
        <input type='button' class='button' value='‚¨Ü'  onmousedown="document.execCommand('insertText', false, '‚¨Ü')">
        <input type='button' class='button' value='‚¨ç'  onmousedown="document.execCommand('insertText', false, '‚¨ç')">
        <input type='button' class='button' value='‚¨á'  onmousedown="document.execCommand('insertText', false, '‚¨á')">
        <input type='button' class='button' value='‚¨à'  onmousedown="document.execCommand('insertText', false, '‚¨à')">
        <input type='button' class='button' value='‚¨â'  onmousedown="document.execCommand('insertText', false, '‚¨â')">
        <input type='button' class='button' value='‚¨ä'  onmousedown="document.execCommand('insertText', false, '‚¨ä')">
        <input type='button' class='button' value='‚¨ã'  onmousedown="document.execCommand('insertText', false, '‚¨ã')"> 
        <br>
        <input type='button' class='button' value='‚óª'  onmousedown="document.execCommand('insertText', false, '‚óª')"   title='BLACK SQUARE'>
        <input type='button' class='button' value='‚óº'  onmousedown="document.execCommand('insertText', false, '‚óº')"   title='WHITE SQUARE'>
        <input type='button' class='button' value='‚ñ¢'  onmousedown="document.execCommand('insertText', false, '‚ñ¢')">
        <input type='button' class='button' value='‚ñ£'  onmousedown="document.execCommand('insertText', false, '‚ñ£')">
        <input type='button' class='button' value='‚ñ§'  onmousedown="document.execCommand('insertText', false, '‚ñ§')">
        <input type='button' class='button' value='‚ñ•'  onmousedown="document.execCommand('insertText', false, '‚ñ•')">
        <input type='button' class='button' value='‚ñ¶'  onmousedown="document.execCommand('insertText', false, '‚ñ¶')">
        <input type='button' class='button' value='‚ñß'  onmousedown="document.execCommand('insertText', false, '‚ñß')">
        <input type='button' class='button' value='‚ñ®'  onmousedown="document.execCommand('insertText', false, '‚ñ®')">
        <input type='button' class='button' value='‚ñ©'  onmousedown="document.execCommand('insertText', false, '‚ñ©')">
        <br>
        <input type='button' class='button' value='‚óÜ'  onmousedown="document.execCommand('insertText', false, '‚óÜ')"   title='BLACK DIAMOND'>
        <input type='button' class='button' value='‚óá'  onmousedown="document.execCommand('insertText', false, '‚óá')"   title='WHITE DIAMOND'>
        <input type='button' class='button' value='‚¨§'  onmousedown="document.execCommand('insertText', false, '‚è∫')"   title='BLACK CIRCLE'>
        <input type='button' class='button' value='‚≠ò'  onmousedown="document.execCommand('insertText', false, '‚≠ò')"   title='WHITE CIRCLE'>
        <input type='button' class='button' value='‚óç'  onmousedown="document.execCommand('insertText', false, '‚óç')">
      </div>
    </div>
    <input type='button' class='button' value='‚úç' onmousedown='formatText(CleanTextElem)'                             title='Format: Ctrl+A'>
    <input type='button' class='button' value='‚ùå' onmousedown="document.execCommand('removeFormat', false, null)"     title='Remove Format'>          
    <input type='button' class='button' value='üîÑ' onmousedown="loadValue(CleanTextElem)"                              title='Load'>
    <input type='button' class='button' value='üíæ' onmousedown="saveValue(CleanTextElem)"                              title='Save'>
    
    <div id='CleanText' spellcheck='true' contenteditable='true' class='textCleanerDiv'></div>

    <script>
        var globalCellObj = {};
        var CleanTextElem = document.getElementById('CleanText');
        function removeUnwantedNodes(elem){
          //remove highlights
          while (mark = elem.querySelector('mark')) 
            mark.outerHTML = mark.innerHTML;
          //remove case-sensitive search tool highlights
          while (span = elem.querySelector('span')) 
            span.outerHTML = span.innerHTML;
          //convert <div> to <br>
          while (div = elem.querySelector('div')) 
            div.outerHTML = div.innerHTML+'<br>';
          //convert <p> to <br>
          while (p = elem.querySelector('p')) 
            p.outerHTML = p.innerHTML+'<br>';
          //remove end <br>
          elem.innerHTML = elem.innerHTML.replace(/(?:<br>|\s)+$/g,'');
        }
        function loadValue(elem){
          google.script.run
          .withSuccessHandler(function(cellObj){
            globalCellObj = cellObj;
            elem.innerHTML = '<p>'+globalCellObj.cellValue+'</p>';
            formatText(CleanTextElem);
            formatText(CleanTextElem);
            })
          .getActiveCell();
        };
        function saveValue(elem){
          formatText(elem);
          //remove highlights
          removeUnwantedNodes(elem);
          google.script.run
            .withFailureHandler(showSnackbar("<b style='color:lightsalmon'>failed to save</b>"))
            .withSuccessHandler(showSnackbar('saved successfully'))
            .setActiveCellValue(JSON.stringify(globalCellObj), 
              elem.innerHTML
              .replace(/^<!--td.*-->|(?:<br>|\s)+$/g, '')
              .replace(/(?:\<br\>)*\s*[\n\r]+\s*/g, '<br>')
              .replace(/(?:&nbsp;|[\s\r\n\x0A])+/g,' ')
              .replace(/^(?:<br>|&nbsp;|[\s\r\n\x0A])+|(?:<b>(?:&nbsp;|[\s\r\n\x0A])*<\/b>)+|(?:<br>|&nbsp;|[\s\r\n\x0A])+$/g,'')
              .replace(/(?:(?:\s|<[bi]>)*<br>(?:\s|<[bi]>)*){2,}/g,'<br>')
              .replace(/&lt;/g,'<')
              .replace(/&gt;/g,'>')
              .replace(/&ndash;/g,'‚Äî')
              .replace(/&amp;/g,'&')
            )
            highlightElem(elem);
        };
        window.onload = function () {
          CleanTextElem = document.getElementById('CleanText');
          
          loadValue(CleanTextElem);
          
          CleanTextElem.addEventListener("paste", function(e) {try{
            // cancel paste
            e.preventDefault();
            
            //get html representation of clipboard if there is html if not get text
            var html = e.clipboardData.getData('text/html');
            if (html) {
              // a temporary element
              var divElem = document.createElement('div');
              divElem.innerHTML = html;
              //convert small-capps to real capital letters
              // in journal of neurosciece they have class sc
              while (smallCapElem = divElem.querySelector('.sc')) 
                smallCapElem.outerHTML = smallCapElem.innerText.toUpperCase();
              
              //convert sub, sup, b, strong, em, italic elems to sth html nutral
              ['p','div','sub','sup','b','i'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@'+tag+'@'+elem.innerHTML+'@|'+tag+'@';
              });
              ['h1','h2','h3','h4','h5','h6'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@p@@b@'+elem.innerHTML+'@|b@@|p@';
              });
              ['strong'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@b@'+elem.innerHTML+'@|b@';
              });
              while (elem = divElem.querySelector('em')) 
                elem.outerHTML = '@i@'+elem.innerHTML+'@|i@';
              
              document.execCommand("insertHTML", false, divElem.innerText
                .replace(/@(su[bp]|[bi])@(.+?)@\|\1@/g,'<$1>$2</$1>')
                .replace(/@(p|div)@(.+?)@\|\1@/g,'$2<br>')
                .replace(/^(?:<br>|[\s\n\r])+|(?:<br>|[\s\n\r])+$/g,'')
              );
            } else {
              document.execCommand("insertHTML", false, e.clipboardData.getData('text/plain').replace(/^[\s\n\r]+|[\s\n\r]+$/g,''));
            }
          }catch(error){
            alert(error)
          }});
        };
    </script>
    <?!= include('shortcuts'); ?>
    <script>
    shortcut.add('Ctrl+.',function(){document.execCommand('superscript', false, null)});
    shortcut.add('Ctrl+,',function(){document.execCommand('subscript', false, null)});
    shortcut.add('Ctrl+m',function(){document.execCommand('insertText', false, '¬µ')});
    shortcut.add('Ctrl+f12',function(){document.execCommand('insertText', false, '‚Äì')});
    shortcut.add('enter',function(){document.execCommand('insertHTML', false, '<br><br>')});
    shortcut.add('f2',function(){saveValue(CleanTextElem)});
    </script>
    
    <?!= include('snackBar'); ?>
  </body>
</html>
