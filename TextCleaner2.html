<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
function highlightElem(elem){
  elem.innerHTML = elem.innerHTML
    .replace(/(\d(?:[\– '&]| \.|.\ | \. )\d|\d Mm|\\| \w \w |\bp[Mm]\b|\bMsec\b|(?<= )[Mm](?= )|µm|\bmm,?\b|,,|[\x01\x02\x03\x04\x05\x06\x07\x08])/g, 
      "<mark class='hotPink'>$1</mark>")          // unautomatable mistakes
}
function formatText(elem) {
  elem = removeUnwantedNodes(elem);
  elem.innerHTML = elem.innerHTML
    .replace('◦','°')//.replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&ndash;/g, '—')
    .replace(/[¬-][\r\n]+|^\s+|(?<=~)\s(?=\d)|(?<=\d[ –-]m)\s+(?=s[ );,.])|(?<=\d)\s+(?=%)|(?<= o) (?=f[ –])|(?<= SR) (?=95531 )|(?<= CGP) (?=55845[ Aa]|52432)/g   , '')
    .replace(/(?<=[(;, ])([Ff]) *i *g *(s)? *\.(?=[ ),;.])/g                                                     , '$1ig$2.') // Fi g. --> Fig.
    .replace(/(?<=[(;, ]R) *(M) *(?=P[ ),;.])/gi                                                                 , '$1')      // R M P --> RMP
    .replace(/(?<!<br>)[\r\n]+|[\t\s]+|&nbsp;|&thinsp;|(?<=tables|table|figures|figure|figs\.|fig\.|figs|fig)(?=\w\w?[ \.\?;,)])(?!s[\. ]?)|(?<=[,;])(?=n=\d)|(?<= of)(?=–\d+)/ig, ' ')
    .replace(/(?<=(?:tables|table|figures|figure|figs\.|fig\.|figs|fig) \w) (?=(?:<(i)>)?\w(?:<\/\1>)?[\– ,)<])/ig, '')       // Fig. 1 A --> Fig. 1A
    .replace(/(?<=[(;, ])([Tt])ruce(s)?(?=[ ),;.])/g                                                             , '$1race$2')
    .replace(/([iI])n *t *e *r? *[mn] *e *u *r *o *n(s*)/g                                                       , '$1nterneuron$2')
    .replace(/(?<=[(;, ])(Na|Cs|K|N)H *[2z,*] *P *[O0] *[4,](?=[ ),;.])/g                                        , '$1H₂PO₄')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *HP[O0] *4(?=[ ),;.])/g                                                , '$1₂HPO₄')
    .replace(/(?<=[(;, ])(Na|Cs|K)CH *3 *S *[O0] *4(?=[ ),;.])/g                                                 , '$1CH₃SO₄')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *[-—–] *[Pp]hosphocreatine(?=[ ),;.])/g                                , '$1₂-phosphocreatine')
    .replace(/(?<=[(;, ])(Na|Cs|K)H *C *[O0] *[3,](?=[ ),;.])/g                                                  , '$1HCO₃')
    .replace(/(?<=[(;, ])(Na|Cs|K) *3 *GTP(?=[ ),;.])/g                                                          , '$1₃GTP')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *(G|A)TP(?=[ ),;.])/g                                                  , '$1₂$2TP')
    .replace(/(?<=[(;, ])(Ca|Mg|Ni|Co|Sr) *C[lI1] *[2z,](?=[ \/),;.])/g                                          , '$1Cl₂')  // 1I as l
    .replace(/(?<=[(;, ])(H|Na|Cs|K) *C[I1](?=[ ),;.])/g                                                         , '$1Cl')   // 1I as l
    .replace(/(?<=[(;, ])M *gS[O0] *4(?=[ ),;.])/g                                                               , 'MgSO₄')
    .replace(/(?<=[(;, ])(Na|Cs|K)MeS[O0] *3(?=[ ),;.])/g                                                        , '$1MeSO₃')//Methylsulfonate = Methanesulfonate
    .replace(/(?<=[(;, ])(Na|Cs|K)MeS[O0] *4(?=[ ),;.])/g                                                        , '$1MeSO₄')//Methylsulfate
    .replace(/(?<=[(;, ]|\.|\.\d)H *[2z,] *[O0](?=[ ),;.])/g                                                     , 'H₂O')
    .replace(/(?<=[(;, \/])C *[O0] *[2z,?J](?=[ ),;.])/g                                                         , 'CO₂')
    .replace(/(?<=[(;, ])[O0] *[2z](?=[ +\/),;.–\-])/g                                                           , 'O₂')
    .replace(/(?<=[\[(\/;, –-])Cl\s*[-−"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ –),;.\]])/g                        , 'Cl⁻')
    .replace(/(?<=[\[(\/;, –-])(Na|K|Cs)\s*[+'"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ -–),;.\]])/g                , '$1⁺')
    .replace(/(?<=[\[(\/;, –-])(Mg|Ca|Sr)\s*[2\*]\s*[+'"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ -–),;.\]])/g       , '$1²⁺')
    .replace(/\[\s*(Cl⁻|Cs⁺|Na⁺|K⁺|Mg²⁺|Ca²⁺)\s*\]/g                                                             , '[$1]')    //[ Ca²⁺ ] -> [Ca²⁺]
    .replace(/(?<=[(;, ])\[(Cl⁻|Na⁺|K⁺|Mg²⁺|Ca²⁺)\]\s*[iI1](?=[ ),;.])/g                                         , '[$1]ᵢ')
    .replace(/(?<=[(;, ])\[(Cl⁻|Na⁺|K⁺|Mg²⁺|Ca²⁺)\]\s*[oO0](?=[ ),;.])/g                                         , '[$1]ₒ')
    .replace(/(?<=[(;, ])\[(Cl⁻|Na⁺|K⁺|Mg²⁺|Ca²⁺)\]\s*[E](?=[ ),;.])/g                                           , '[$1]<sub>E</sub>')
    .replace(/(?<=[(;, ])et\s*a[1!]\.(?=[ ),;.])/g                                                               , 'et al.')
    .replace(/(?<=[(;, ])C *A\s*[lI](?=[ ),;.])/g                                                                , 'CA1')     // lI as 1
    .replace(/(?<=[(;, ])C *A *([1-4])(?=[ ),;.])/g                                                              , 'CA$1')    // C A 1 --> CA1
    .replace(/(?<=[(;, ])([Ff]igs*|FIGS*)(\.*) *[lI]([A-Za-z]{0,2})(?=[ ),;.])/g                                 , '$1$2 1$3')// lI as 1
    .replace(/(?<=[(;,=><~≤≥ ])(\d*)\s*[lI]\s*(\d+[.]\d+|\d+)(?<![(;,=><~≤≥ ]I\d)(?=[ ),;.])/g                   , '$11$2')   // lI as 1
    .replace(/([(;, ].{1,3}[=><~≤≥])\s*(\d+\.\d+|\d+)\s*[lI]\s*(?=\d*[ ,;.)])/g                                  , '$1$21')   // lI as 1
    .replace(/(?<=[(;, ])(GABA)[-—–_ ]*[Aa](?=\s*-*\s*receptor|[ ),;.])/g                                        , '$1-A')    // GABA-A
    .replace(/(?<=[(;, ])(GABA)[-—–_ ]*[8B](?=\s*-*\s*receptor|[ ),;.])/g                                        , '$1-B')    // GABA-B
    .replace(/(?<=[(;, ])[od][-—–_ ]AP(V|5)(?=[ ),;.])/g                                                         , 'D-AP$1')
    .replace(/(?<=[(\/\d])(\s*mM\s*)?QX\s*[-–]?314(?=[ ),;.])/g                                                  , '$1QX314')
    .replace(/(?<=\d\s)mm(?=\s*(?:(?:Na{0,1}|C[als]|K|Mg|potassium|sodium|calcium|cesium|disodium)(?:²⁺|⁺|⁻|(?:₂H|H₂)PO₄|(?:CH₃|Me)*SO[₃₄]|[- ](?:phosphocreatine|gluconate)|HCO₃|[₃₂]*[GA]TP|Cl₂*|OH){0,1}[ ,;\/.)]|EGTA|[GA]TP|HEPES|QX.{0,1}314|TEA|glucose))|(?<=[(;, ]in )mm(?=[ ),;.])|(?<=QX–314 \(\d+ )mm(?=\))/g
                                                                                                                 , 'mM')
    .replace(/(?<=[(;, ])m M(?=[ ),;.])/g                                                                        , 'mM')
    .replace(/(?<=[(\d])\s*(?:mY|m V|mV)(?=[ ),;.])/g                                                            , ' mV')
    .replace(/(\d+(?:\.\d+){0,1})([^<>)(\d]{0,1})(?:F[Li]?|[Uut]|\/[uxnijt\/\^]|[mg]u|I[Lt]|J\.*L|JI|j[af<iu]|[\(]i|i[xj]|p[\.Rut]|[!tl]J\.|[-~]t|,u\.?|#£|\|x|[gì\x01\x02\x03\x04\x05\^])\s*([MmsA]|m2|rn|[Ss]ec)(?<!gm)(?=[ ),;.–]|.thick)/g,
      function(fullMatch,p1,p2,p3){
        return p1+((p2)?p2:' ')+'µ'+((p3 === 'm2')?'m²':((p3==='rn')?'m':p3))})                                                                 //µM
    .replace(/(?<=[(\d])\s*(?:[pP]|\|x)(M)(?=[ ),;.])/g                                                          , ' µ$1')    //µM µV not PV+
    .replace(/\|/g                                                                                               , 'I')
    .replace(/(?<=[(\d])\s*[\x01\x02\x03\x04\x05]\s*([tT])(?=[ ),;.])/g                                          , ' Δ$1')
    .replace(/(?<=[(\d])\s*([GM])\s*(?:[ÙQ\x01\x02\x03\x04\x05\x06\x07O]|[Oo]mega|[St1I]2|IL|f[li])(?=[ ),;.])/g, ' $1Ω')
    .replace(/([(;, ]R)(?:m|,,|, ?n)(,? \d+(?:\.\d+)?(?:±\d+\.?\d*)? MΩ)/g                                       , ' $1<sub>in</sub>$2') //R,, -> Rin
    .replace(/(?<=\d)\sÒ/g                                                                                       , ' M')
    .replace(/(?<=[\(\s])CV\s*[\x01\x02\x03\x04\x05\x06\x07-−]\s*2(?=[\s\)])/g                                  , 'CV⁻²')
    .replace(/(?<=\s)1[\/]CV 2(?=\s)/g                                                                           , '1/CV²')
    .replace(/(?<=\d)\s*mm\s*2(?=[\s,])/g                                                                        , ' mm²')
    .replace(/(?<=\s)((?:mS[\s·])?[cm]m)\s*[\-–]\s*2(?=[\s,])/g                                                  , '$1⁻²')
    .replace(/(?<=\d)\s*o\/o(?=[ ),;.])/g                                                                        , '%')
    .replace(/(?<=[\s·])(min|m⋅?[gsL]|[µc]m)\s*[-–]\s*1(?=[\s)])/g                                                , '$1⁻¹')
    .replace(/wÏv/g                                                                                              , 'w/v')
    .replace(/ﬁ/g                                                                                                , 'fi')
    .replace(/Greek Letter Mu|&micro;\s*|μ|&mu;/g                                                                , 'µ')       //ALT+230 convert unicode to ascii
    .replace(/(?:\\tau|&tau;|(?<= )tau(?= )|tau(?= *=)|((?:time constants*|decay|rise) *\(*)tau\)*)/ig           , '$1τ')     //ALT+231
    .replace(/omega([^<>)(]{0,1}(?:aga|cono)toxin)/g                                                             , 'ω$1')
    .replace(/(?<=\d)\s*[·*]\s*(?=\d)|(?<=[ ±+–]0)–?(?=(?:0\d+|[1-9])[ ±+])/g                                    , '.')       // decimal point  |(?<=[ +=]\d)[–'](?=\d+[ +])
    .replace(/(?<=[ =,;(]\d+)[–'&.](\d+)\s*([+±–])\s*(\d+)[–'&.](?=\d+[ ),;])/g                                  , '.$1$2$3.')//\d–\d–\d–\d --> \d.\d–\d.\d)
    .replace(/(?<=[A-Za-z])\s*[-−](\s*)(?=[A-Za-z])/g                                                            , '-$1')     // negative as hiphen between two words
    .replace(/(?<=[\w¹²³₂₃₄⁺⁻αßµτΔΩγ])[–—−-](?=[\w¹²³₂₃₄⁺⁻αßµτΔΩγ])/g                                             , '–')       // normal hiphen as big hiphen or negative signs between two words
    .replace(/(?<=[(;, ])(?:<(i)>)?\s*t\s*(?:<\/\1>)?\s*test/ig                                                  , 't–test')  // t–test
    .replace(/&minus;|(?<= [∼(]) *[–—−](?=\d)|(?<=[(;, ])[–—−](?=\d+[– ]ms)/g                                    , '-')       // ngative
    .replace(/(?<=[\d])\s*(?:[–—−]|&ndash;)\s*(\d+)\s*(?=%)/g                                                    , '-$1')     // 20-80%
    .replace(/(?<=[(;, ])[I1]–0(?=[ ),;.])/g                                                                     , 'I-O')
    .replace(/(?<=[(;, ])[n«]\s*(?:[\x01\x02\x03\x04\x05\x06\x07\x08]*| -|=)\s*(?=\d+[ ),;.])/g                  , 'n=')
    .replace(/(?<=[(;, ])([pP])\s*[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=0*\.0(5|1|01)[ ),;.])/g                , '$1<')
    .replace(/(?<=[(;, ])([pP])\s*[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?!0*\.0(5|1|01))(?=0*\.0\d+[ ),;.])/g    , '$1=')
    .replace(/(?<=\<\/sub>)\s*[\x01\x02\x03\x04\x05\x06\x07\x08](?=[ ),;.])/g                                    , '=')
    .replace(/plusminus|&plusmn;/g                                                                               , '±')
    .replace(/(?<=[(;, >=])([\-−+]{0,1}\d+(?:\.\d+){0,1})(?<!55845|95531|314|222)\s*(.{0,1}Ω|[µμ].{0,1}|°C|m[MVs]|m[lL].{0,1}min|[pn][ASF]|Hz|%)*\s*(?:[±+\x01\x02\x03\x04\x05\x06\x07\xAD])\s*(?=\d+(?:\.\d+){0,1}[ )%,;°.<])/g
                                                                                                                 , '$1$2±')//\d ± \d    --> \d±\d
    .replace(/([(;, \][\/])([Mm]eans?|MEANS?)\s*(?:[±+\x01\x02\x03\x04\x05\x06\x07\xAD])\s*(?=[Ss][\.\/]?[EeDd]\.?[Mm]?)/g
                                                                                                                 , '$1$2±')     // Mean ± SEM --> Mean±SEM
    .replace(/(?<=[A-Za-z=,(])(\s*)[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=[5-8][05][ ),;.])/g                   , '$1-')     // control character as negative sign for values <-50
    .replace(/(?<=[A-Za-z=,(])(\s*)[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=\d+[±.]\d+[ ),;.±])/g                 , '$1-')     // control character as negative sign between a word and a number with decimals
    .replace(/(?<=[=><(≤≥~ ])(\s*)[–—−]\s*(?=(?:\d+[.]\d+|\d+)[ ),;.±])/g                                        , '$1-')     // hiphen as negative sign
    .replace(/(?<=\w[(;, ])(\s*[~+\-><≈])\s(?=(?:\d+[.]\d+|\d+)[ ),;.±])/g                                       , '$1')      // [~+-><]\s\d
    .replace(/approx(?=\d)/g                                                                                     , '~')
    .replace(/(?<=\w)\s*[(]\s(?=-{0,1}[\wΔµ])/g                                                                  , ' (')
    .replace(/(?<=[\w\dΩ])\s[)]\s*(?=[:.,;])/g                                                                   , ')')
    .replace(/(?<=[\w\dΩ%])(?<!phenoxy)\s*[)]\s*(?=[\w])(?!ethane)/g                                             , ') ')
    .replace(/(?<=[\w¹²₂₃₄Ω])(?<![-,]N|&amp|&lt|&gt|&ndash|&plusmn|&minus|&tau)\s*([,;%])\s*(?=[A-Za-z])(?!N,|-tetraacetic)/g, '$1 ')     // space after ,;%
    .replace(/\s*(?:=<(?!(?:sub|s|i|b|br|em|div|strong)>)|<=)\s*/g                                               , '≤')
    .replace(/(?<=sub|s|i|b|em|br|div|strong)(?!>=)> *= *(?=\d)/g                                                , '>=')
    .replace(/\s*(?:=>|>=(?<!sub>=|s>=|i>=|b>=|em>=|br>=|div>=|strong>=))\s*/g                                   , '≥')
    .replace(/-->/g                                                                                              , '➞')
    .replace(/<--/g                                                                                              , '⬅')
    .replace(/<->/g                                                                                              , '⬌')
    .replace(/^[ .?!)}]]+(?=\w)|\xAD/g                                                                           , '')
    .replace(/(?<!\..)(?<=[\w₀₁₂₃₄₅₆₇₈₉ₙₘ⁰¹²³⁵⁶⁷⁸⁹)])\s*\.\s*(?=[a-zA-z]+\s)/g                                     , '. ')
    .replace(/\s*\.+\s*$/g                                                                                       , '.')
    .replace(/(?<=[(;, ])V *(amp|hold(?:ing)?|thresh*)(?=[ =),;.])/ig                                            , '𝑉<sub>$1</sub>')
    .replace(/(?<=[(;, ])(?:[trτ]|tau) *(D|d|R|decay|rise)(?=[ =),;.])/g                                         , 'τ<sub>$1</sub>')
    .replace(/(?<=[(;, –])([EI]) *(K|Na|C[lsa]|rev|GABA)(?=[ =),;.])/g                                           , '$1<sub>$2</sub>')
    .replace(/(?<=[(;, ])R *([Ss]|in|IN)(?=[ =),;.])/g                                                           , 'R<sub>$1</sub>')// Rin Rs
    .replace(/(?<=[(;, ])C *([mM])(?=[ =),;.])/g                                                                 , 'C<sub>$1</sub>')// Cm --> Cₘ  [not cm = centimiter]
    .replace(/(?<=[A-Za-z]{3}|[)])\s*(\d+(?:,\s*\d+)+)(?=\s\(|[.,]\s|\.$)(?![,]? and)/g                          , '<sup>$1</sup>') // numerical references
    .replace(/(?:((?<=[(;, ])(?:ms|min|sec|µm|χ)|\^)([-–−]*\s*\d+(?:\.\d+)*(?!–))|(?<!alexa|prox|and|was|[Tt]able|[Ff]igure|paradigm|cell|neuron|actinin|GAD)(?<=[a-z]{3}|[)])\s*([\d–]{1,3})(?=\.(?:\s|<br>)|\.$))/g, 
      function(fullMatch,p1,p2,p3){
        var prefix = ((p1 === '^' || !p1) ? '' : p1)
        var num = Array.from((p2)?p2:p3).reduce(
          function(num,digit){
            switch (digit) {
              case "0": return num+'⁰'; break;
              case "1": return num+'¹'; break;
              case "2": return num+'²'; break;
              case "3": return num+'³'; break;
              case "4": return num+'⁴'; break;
              case "5": return num+'⁵'; break;
              case "6": return num+'⁶'; break;
              case "7": return num+'⁷'; break;
              case "8": return num+'⁸'; break;
              case "9": return num+'⁹'; break;
              case "-": return num+'⁻'; break;
              case "–": return num+'⁻'; break;
              case "−": return num+'⁻'; break;
              case ".": return num+'⋅'; break;
              default : return num; break;
          }
        },'');
        return prefix+num
      })                                                                                                                        //µm²
    .replace(/((?<=[\/(;, ])[vrτ]|[esmu]{0,1}\.{0,1}[ei]\.{0,1}p\.{0,1}s\.{0,1}[cp]|_)(\d+|\s\d|\s*[nmhi])(?<!c57|CI|RI)(?=[ =\/),;.+](?!ANOVA)|\s*<\/)/ig, //RI = Resistance Internal != Rectification Index
      function(fullMatch,p1,p2){
        var prefix = ((p1 === '_') ? '' : p1);
        var num = Array.from(p2).reduce(
          function(num,digit){
            switch (digit) {
              case "0": return num+'₀'; break;
              case "1": return num+'₁'; break;
              case "2": return num+'₂'; break;
              case "3": return num+'₃'; break;
              case "4": return num+'₄'; break;
              case "5": return num+'₅'; break;
              case "6": return num+'₆'; break;
              case "7": return num+'₇'; break;
              case "8": return num+'₈'; break;
              case "9": return num+'₉'; break;
              case "n": return num+'ₙ'; break;
              case "N": return num+'<sub>N</sub>'; break;
              case "m": return num+'ₘ'; break;
              case "M": return num+'<sub>M</sub>'; break;
              case "h": return num+'ₕ'; break;
              case "H": return num+'<sub>H</sub>'; break;
              case "i": return num+'ᵢ'; break;
              case "I": return num+'<sub>I</sub>'; break;
              default : return num; break;  // removes space
            }
          },'')
        return prefix+num
      })  //τ₁ PSC₁
    .replace(/(?<=[(;, ])(\w+(?:<su[bp]>\w+<\/su[bp]>|[₀₁₂₃₄₅₆₇₈₉⁰¹²³⁵⁶⁷⁸⁹ₕᵢₘₙₒ])*(?:[:\/\+\-]\w+(?:<su[bp]>\w+<\/su[bp]>|[₀₁₂₃₄₅₆₇₈₉⁰¹²³⁵⁶⁷⁸⁹ₕᵢₘₙₒ])*)*|\[\w\w²{0,1}[⁻⁺]\][ᵢₒ]{0,1})\s([><±≤≥])\s*(?=[-+]{0,1}\d)/g
                                                                                                                 , '$1 $2')     //[><≤≥±] \d --> [><≤≥±]\d //[^aI ]|[^awhumboie ][^lenyfptio ]|sub>
    .replace(/(PV|CB1{0,1}|CR|CCK|SOM|VIP)\s([+-])/g                                                             , '$1$2')      // PV +/CCK + BC --> PV+/CCK+ BC, 
    .replace(/(?<=[(;, \]\/])(sub>|[αßγδεζηθλκζξµρτπφχψωσ∆Ω\w₀₁₂₃₄₅₆₇₈₉⁰¹²³⁵⁶⁷⁸⁹ₕᵢₘₙ]+)\s*([=])\s*(?=[-+]{0,1}\d)/g , '$1$2')      // word = \d --> word=\d
    .replace(/(?<=[(;, \]\/])(\**p)\s*([<>≤≥]|&lt;|&gt;)\s*(?=-{0,1}\d)/gi                                       , '$1$2')      // p < \d --> p<\d
    .replace(/\s+\<(br|\/td)>/g                                                                                  , '<$1>')
    .replace(/(^[\-– \w]{1,100}? )([Aa](?: and [Bb]){0,1},)(?= )/                                                , '<b>$1</b><br>$2') // bold the first sentence of the images
    .replace(/((?:<br>\s*|(?<![Ff]igs|[Ff]ig|refs|ref|vs|et[ .]?al|\(\w{1,2})\.\s)(?:(?=\([^.)]{1,20}\))|(?!\w{1,3}[\. ]|\(|<b>[^.,<>]{1,20}<\/b> )))(\(?(?:(?:\w[a-z1-9]?|<b>\w[a-z1-9]?<\/b>)(?:(?:[,\-– ]{1,2}|and|or){1,3}(?:\w[a-z1-9]?|<b>\w[a-z1-9]?<\/b>)){0,2}|<b>\w[a-z1-9]?(?:(?:[,\-– ]{1,2}|and|or){1,3}\w[a-z1-9]?){0,2}<\/b>)(?:[\),]|(?<=(?:and|or) \w[a-z1-9]?)))(?= )/g,
      function(fullMatch,p1,p2){
        return ((p1==='. ')?'.':'')+'<br><b>'+p2.replace(/<\/?b>/g,'')+'</b>';                                      })          // a-b, bold image list                                                                                                                        
    .replace(/(?<=[\.;]\s|<\/?b>)((?:(?:right|left|top|bottom|middle|center|insets?)\s*(?:panel|trace|left|right|top|bottom|middle|center)?[,:]\s*)+)(?=\s)/ig,' <b>$1</b>') // bold subsections in figures
    .replace(/^([^.,?]+\.)\s*(?=<br>)/g                                                                          , '<b>$1</b>') // bold the 1st sentence
    .replace(/(?:<br><i>)([\w ]*?\.)(?:<\/i>(?:<br>)*)/g                                                         , '<br><b>$1</b><br>') // bold subsections
    .replace(/(?:[\n\s]*(?:<br>)+(?!\n)|(?:<br>)+\n+)/g                                                          , '<br>')
    .replace(/<\/b>\s*<b>/g                                                                                      , ' ')
    .replace(/ *> +< */g                                                                                         , '><')
    //.replace(/<p>/g                                                                                              , '&lt;p&gt;')
    .replace(/(\d)\s*\/\s*(\d)(?<!\d\/\d)/g                                                                      ,'$1/$2'); //remove space between numbers and /
    highlightElem(elem);
    if (typeof elem.forceSpellCheck === 'function') elem.forceSpellCheck();
};
    </script>
    <style>
      body {
        margin: 0px;
        background-color: #e8eaf6;
      }
      .textCleanerDiv {
        width: calc(100vw - 0px);
        height: calc(100vh - 26px);
        padding: 1px;
        font-family: Verdana, Arial, Helvetica, sans-serif;/*'Open Sans', sans-serif;*/
        font-size: 16px;
        //letter-spacing: 1px;
        line-height: 1.5em;
        display: block;
        position: absolute;
        margin: 0;
        border: 2px solid #74637f;
        border-radius: 0;
        color: black;
        background-color: white;
        overflow: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
        display:inline-block;/* contenteditable elem will not generate div, p and span automatically in Chrome.*/
      }
      .textCleanerDiv br {
        line-height:200%;
      }
      .textCleanerDiv sup {
        font-size: 58%;
        font-weight: bold;
        vertical-align: 20%;
      }
      input {
        height:20px;
        /*width:19px;*/
      }
      .hotPink{
        background-color:hotpink;
      }
    </style>
    <?!=include('commonCSS')?>
  </head>
  <body>
    <title>PDF Text Cleaner Tool</title>
    <input   type='button' class='button' value='✍' onmousedown='formatText(CleanTextElem)'                        title='Format: Ctrl+A'>
    <div class="dropdown">
      <input   type='button' class='button' value='🔣'>
      <div class="dropdown-content">
        <input type='button' class='button' value='⌂'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().replace(/ /g, ''))" title='remove all spaces'>
        <input type='button' class='button' value='🆄'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().toUpperCase());" title='to UpperCase'>
        <input type='button' class='button' value='🅻'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().toLowerCase());" title='to LowerCase'>
        <br>
        <input type='button' class='button' value='°'  onmousedown="document.execCommand('insertText', false, '°')"   title='degree'>
        <input type='button' class='button' value='±'  onmousedown="document.execCommand('insertText', false, '±')"   title='plus minus'>
        <input type='button' class='button' value='×'  onmousedown="document.execCommand('insertText', false, '×')"   title='multiply'>
        <input type='button' class='button' value='√'  onmousedown="document.execCommand('insertText', false, '√')"   title='root square'>
        <input type='button' class='button' value='∑'  onmousedown="document.execCommand('insertText', false, '∑')"   title='Zigma'>
        <input type='button' class='button' value='≈'  onmousedown="document.execCommand('insertText', false, '≈')"   title='almost equal to'>

        <input type='button' class='button' value='Φ'  onmousedown="document.execCommand('insertText', false, 'Φ')"   title='Phi'>
        <input type='button' class='button' value='ψ'  onmousedown="document.execCommand('insertText', false, 'ψ')"   title='Psi'>
        <input type='button' class='button' value='ω'  onmousedown="document.execCommand('insertText', false, 'ω')"   title='Omega'>
        <input type='button' class='button' value='σ'  onmousedown="document.execCommand('insertText', false, 'σ')"   title='Sigma'>
        <input type='button' class='button' value='Δ'  onmousedown="document.execCommand('insertText', false, 'Δ')"   title='Delta'>
        <input type='button' class='button' value='Ω'  onmousedown="document.execCommand('insertText', false, 'Ω')"   title='Omega'>
        <br>
        <input type='button' class='button' value='α'  onmousedown="document.execCommand('insertText', false, 'α')"   title='alpha'>
        <input type='button' class='button' value='ß'  onmousedown="document.execCommand('insertText', false, 'ß')"   title='beta'>
        <input type='button' class='button' value='γ'  onmousedown="document.execCommand('insertText', false, 'γ')"   title='gamma'>
        <input type='button' class='button' value='δ'  onmousedown="document.execCommand('insertText', false, 'δ')"   title='delta'>
        <input type='button' class='button' value='ε'  onmousedown="document.execCommand('insertText', false, 'ε')"   title='epsilon'>
        <input type='button' class='button' value='ζ'  onmousedown="document.execCommand('insertText', false, 'ζ')"   title='zeta'>
        <input type='button' class='button' value='η'  onmousedown="document.execCommand('insertText', false, 'η')"   title='eta'>
        <input type='button' class='button' value='θ'  onmousedown="document.execCommand('insertText', false, 'θ')"   title='theta'>
        <input type='button' class='button' value='λ'  onmousedown="document.execCommand('insertText', false, 'λ')"   title='lamda'>
        <input type='button' class='button' value='κ'  onmousedown="document.execCommand('insertText', false, 'κ')"   title='kappa'>
        <input type='button' class='button' value='ζ'  onmousedown="document.execCommand('insertText', false, 'ζ')"   title='zeta'>
        <input type='button' class='button' value='ξ'  onmousedown="document.execCommand('insertText', false, 'ξ')"   title='xi'>
        <input type='button' class='button' value='µ'  onmousedown="document.execCommand('insertText', false, 'µ')"   title='mu, shortcut:Ctrl+M'>
        <input type='button' class='button' value='ρ'  onmousedown="document.execCommand('insertText', false, 'ρ')"   title='rho'>
        <input type='button' class='button' value='τ'  onmousedown="document.execCommand('insertText', false, 'τ')"   title='tau'>
        <input type='button' class='button' value='π'  onmousedown="document.execCommand('insertText', false, 'π')"   title='pi'>
        <input type='button' class='button' value='φ'  onmousedown="document.execCommand('insertText', false, 'φ')"   title='phi'>
        <input type='button' class='button' value='χ'  onmousedown="document.execCommand('insertText', false, 'χ')"   title='chi'>
        <br>
        <input type='button' class='button' value='⁰'  onmousedown="document.execCommand('insertText', false, '⁰')"   title='Superscript'>
        <input type='button' class='button' value='¹'  onmousedown="document.execCommand('insertText', false, '¹')"   title='Superscript'>
        <input type='button' class='button' value='²'  onmousedown="document.execCommand('insertText', false, '²')"   title='Superscript'>
        <input type='button' class='button' value='³'  onmousedown="document.execCommand('insertText', false, '³')"   title='Superscript'>
        <input type='button' class='button' value='⁴'  onmousedown="document.execCommand('insertText', false, '⁴')"   title='Superscript'>
        <input type='button' class='button' value='⁵'  onmousedown="document.execCommand('insertText', false, '⁵')"   title='Superscript'>
        <input type='button' class='button' value='⁶'  onmousedown="document.execCommand('insertText', false, '⁶')"   title='Superscript'>
        <input type='button' class='button' value='⁷'  onmousedown="document.execCommand('insertText', false, '⁷')"   title='Superscript'>
        <input type='button' class='button' value='⁸'  onmousedown="document.execCommand('insertText', false, '⁸')"   title='Superscript'>
        <input type='button' class='button' value='⁹'  onmousedown="document.execCommand('insertText', false, '⁹')"   title='Superscript'>
        <input type='button' class='button' value='⁺'  onmousedown="document.execCommand('insertText', false, '⁺')"   title='Superscript'>
        <input type='button' class='button' value='⁻'  onmousedown="document.execCommand('insertText', false, '⁻')"   title='Superscript'>
        <input type='button' class='button' value='⁼'  onmousedown="document.execCommand('insertText', false, '⁼')"   title='Superscript'>
        <input type='button' class='button' value='⁽'  onmousedown="document.execCommand('insertText', false, '⁽')"   title='Superscript'>
        <input type='button' class='button' value='⁾'  onmousedown="document.execCommand('insertText', false, '⁾')"   title='Superscript'>
        <br>
        <input type='button' class='button' value='₀'  onmousedown="document.execCommand('insertText', false, '₀')"   title='Subscript'>
        <input type='button' class='button' value='₁'  onmousedown="document.execCommand('insertText', false, '₁')"   title='Subscript'>
        <input type='button' class='button' value='₂'  onmousedown="document.execCommand('insertText', false, '₂')"   title='Subscript'>
        <input type='button' class='button' value='₃'  onmousedown="document.execCommand('insertText', false, '₃')"   title='Subscript'>
        <input type='button' class='button' value='₄'  onmousedown="document.execCommand('insertText', false, '₄')"   title='Subscript'>
        <input type='button' class='button' value='₅'  onmousedown="document.execCommand('insertText', false, '₅')"   title='Subscript'>
        <input type='button' class='button' value='₆'  onmousedown="document.execCommand('insertText', false, '₆')"   title='Subscript'>
        <input type='button' class='button' value='₇'  onmousedown="document.execCommand('insertText', false, '₇')"   title='Subscript'>
        <input type='button' class='button' value='₈'  onmousedown="document.execCommand('insertText', false, '₈')"   title='Subscript'>
        <input type='button' class='button' value='₉'  onmousedown="document.execCommand('insertText', false, '₉')"   title='Subscript'>
        <input type='button' class='button' value='₊'  onmousedown="document.execCommand('insertText', false, '₊')"   title='Subscript'>
        <input type='button' class='button' value='₋'  onmousedown="document.execCommand('insertText', false, '₋')"   title='Subscript'>
        <input type='button' class='button' value='₌'  onmousedown="document.execCommand('insertText', false, '₌')"   title='Subscript'>
        <input type='button' class='button' value='₍'  onmousedown="document.execCommand('insertText', false, '₍')"   title='Subscript'>
        <input type='button' class='button' value='₎'  onmousedown="document.execCommand('insertText', false, '₎')"   title='Subscript'>
        <br>
        <input type='button' class='button' value='ᵃ'  onmousedown="document.execCommand('insertText', false, 'ᵃ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵇ'  onmousedown="document.execCommand('insertText', false, 'ᵇ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᶜ'  onmousedown="document.execCommand('insertText', false, 'ᶜ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵈ'  onmousedown="document.execCommand('insertText', false, 'ᵈ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵉ'  onmousedown="document.execCommand('insertText', false, 'ᵉ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᶠ'  onmousedown="document.execCommand('insertText', false, 'ᶠ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵍ'  onmousedown="document.execCommand('insertText', false, 'ᵍ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ʰ'  onmousedown="document.execCommand('insertText', false, 'ʰ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ⁱ'  onmousedown="document.execCommand('insertText', false, 'ⁱ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ʲ'  onmousedown="document.execCommand('insertText', false, 'ʲ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵏ'  onmousedown="document.execCommand('insertText', false, 'ᵏ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ˡ'  onmousedown="document.execCommand('insertText', false, 'ˡ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵐ'  onmousedown="document.execCommand('insertText', false, 'ᵐ')"   title='Superscript Minuscule'> 
        <input type='button' class='button' value='ⁿ'  onmousedown="document.execCommand('insertText', false, 'ⁿ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵒ'  onmousedown="document.execCommand('insertText', false, 'ᵒ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵖ'  onmousedown="document.execCommand('insertText', false, 'ᵖ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ʳ'  onmousedown="document.execCommand('insertText', false, 'ʳ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ˢ'  onmousedown="document.execCommand('insertText', false, 'ˢ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵗ'  onmousedown="document.execCommand('insertText', false, 'ᵗ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵘ'  onmousedown="document.execCommand('insertText', false, 'ᵘ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵛ'  onmousedown="document.execCommand('insertText', false, 'ᵛ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ʷ'  onmousedown="document.execCommand('insertText', false, 'ʷ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ˣ'  onmousedown="document.execCommand('insertText', false, 'ˣ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ʸ'  onmousedown="document.execCommand('insertText', false, 'ʸ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᶻ'  onmousedown="document.execCommand('insertText', false, 'ᶻ')"   title='Superscript Minuscule'>
        <br>
        <input type='button' class='button' value='ᴬ'  onmousedown="document.execCommand('insertText', false, 'ᴬ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴮ'  onmousedown="document.execCommand('insertText', false, 'ᴮ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴰ'  onmousedown="document.execCommand('insertText', false, 'ᴰ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴱ'  onmousedown="document.execCommand('insertText', false, 'ᴱ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴳ'  onmousedown="document.execCommand('insertText', false, 'ᴳ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴴ'  onmousedown="document.execCommand('insertText', false, 'ᴴ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴵ'  onmousedown="document.execCommand('insertText', false, 'ᴵ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴶ'  onmousedown="document.execCommand('insertText', false, 'ᴶ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴷ'  onmousedown="document.execCommand('insertText', false, 'ᴷ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴸ'  onmousedown="document.execCommand('insertText', false, 'ᴸ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴹ'  onmousedown="document.execCommand('insertText', false, 'ᴹ')"   title='Superscript Capital'> 
        <input type='button' class='button' value='ᴺ'  onmousedown="document.execCommand('insertText', false, 'ᴺ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴼ'  onmousedown="document.execCommand('insertText', false, 'ᴼ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴾ'  onmousedown="document.execCommand('insertText', false, 'ᴾ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᴿ'  onmousedown="document.execCommand('insertText', false, 'ᴿ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᵀ'  onmousedown="document.execCommand('insertText', false, 'ᵀ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᵁ'  onmousedown="document.execCommand('insertText', false, 'ᵁ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ⱽ'  onmousedown="document.execCommand('insertText', false, 'ⱽ')"   title='Superscript Capital'>
        <input type='button' class='button' value='ᵂ'  onmousedown="document.execCommand('insertText', false, 'ᵂ')"   title='Superscript Capital'>
        <br>
        <input type='button' class='button' value='ₐ'  onmousedown="document.execCommand('insertText', false, 'ₐ')"   title='Subscript'>
        <input type='button' class='button' value='ₑ'  onmousedown="document.execCommand('insertText', false, 'ₑ')"   title='Subscript'>
        <input type='button' class='button' value='ₒ'  onmousedown="document.execCommand('insertText', false, 'ₒ')"   title='Subscript'>
        <input type='button' class='button' value='ₓ'  onmousedown="document.execCommand('insertText', false, 'ₓ')"   title='Subscript'>
        <input type='button' class='button' value='ₔ'  onmousedown="document.execCommand('insertText', false, 'ₔ')"   title='Subscript'>
        <input type='button' class='button' value='ₕ'  onmousedown="document.execCommand('insertText', false, 'ₕ')"   title='Subscript'>
        <input type='button' class='button' value='ᵢ'  onmousedown="document.execCommand('insertText', false, 'ᵢ')"   title='Subscript'>
        <input type='button' class='button' value='ⱼ'  onmousedown="document.execCommand('insertText', false, 'ⱼ')"   title='Subscript'>
        <input type='button' class='button' value='ₖ'  onmousedown="document.execCommand('insertText', false, 'ₖ')"   title='Subscript'>
        <input type='button' class='button' value='ₗ'  onmousedown="document.execCommand('insertText', false, 'ₗ')"   title='Subscript'>
        <input type='button' class='button' value='ₘ'  onmousedown="document.execCommand('insertText', false, 'ₘ')"   title='Subscript'>
        <input type='button' class='button' value='ₙ'  onmousedown="document.execCommand('insertText', false, 'ₙ')"   title='Subscript'>
        <input type='button' class='button' value='ₒ'  onmousedown="document.execCommand('insertText', false, 'ₒ')"   title='Subscript'>
        <input type='button' class='button' value='ₚ'  onmousedown="document.execCommand('insertText', false, 'ₚ')"   title='Subscript'>
        <input type='button' class='button' value='ᵣ'  onmousedown="document.execCommand('insertText', false, 'ᵣ')"   title='Subscript'>
        <input type='button' class='button' value='ₛ'  onmousedown="document.execCommand('insertText', false, 'ₛ')"   title='Subscript'>
        <input type='button' class='button' value='ₜ'  onmousedown="document.execCommand('insertText', false, 'ₜ')"   title='Subscript'>     
        <input type='button' class='button' value='ᵤ'  onmousedown="document.execCommand('insertText', false, 'ᵤ')"   title='Subscript'>
        <input type='button' class='button' value='ᵥ'  onmousedown="document.execCommand('insertText', false, 'ᵥ')"   title='Subscript'>
        <input type='button' class='button' value='ₓ'  onmousedown="document.execCommand('insertText', false, 'ₓ')"   title='Subscript'>
        <input type='button' class='button' value='ᵦ'  onmousedown="document.execCommand('insertText', false, 'ᵦ')"   title='Subscript'>
        <input type='button' class='button' value='ᵧ'  onmousedown="document.execCommand('insertText', false, 'ᵧ')"   title='Subscript'>     
        <input type='button' class='button' value='ᵨ'  onmousedown="document.execCommand('insertText', false, 'ᵨ')"   title='Subscript'>
        <input type='button' class='button' value='ᵩ'  onmousedown="document.execCommand('insertText', false, 'ᵩ')"   title='Subscript'>
        <input type='button' class='button' value='ᵪ'  onmousedown="document.execCommand('insertText', false, 'ᵪ')"   title='Subscript'>
        
        <input type='button' class='button' value='ᵅ'  onmousedown="document.execCommand('insertText', false, 'ᵅ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵝ'  onmousedown="document.execCommand('insertText', false, 'ᵝ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵞ'  onmousedown="document.execCommand('insertText', false, 'ᵞ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵟ'  onmousedown="document.execCommand('insertText', false, 'ᵟ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᶿ'  onmousedown="document.execCommand('insertText', false, 'ᶿ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᶥ'  onmousedown="document.execCommand('insertText', false, 'ᶥ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵠ'  onmousedown="document.execCommand('insertText', false, 'ᵠ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='ᵡ'  onmousedown="document.execCommand('insertText', false, 'ᵡ')"   title='Superscript Minuscule'>
        
        <br>
        <input type='button' class='button' value='◀'  onmousedown="document.execCommand('insertText', false, '◀')"  title='Backward triangle'>
        <input type='button' class='button' value='▲'  onmousedown="document.execCommand('insertText', false, '▲')"   title='up triangle'>
        <input type='button' class='button' value='▼'  onmousedown="document.execCommand('insertText', false, '▼')"   title='down triangle'>
        <input type='button' class='button' value='▶'  onmousedown="document.execCommand('insertText', false, '▶')"  title='Forward triangle'>
        <input type='button' class='button' value='◁'  onmousedown="document.execCommand('insertText', false, '◁')"  title='Backward triangle'>
        <input type='button' class='button' value='△'  onmousedown="document.execCommand('insertText', false, '△')"  title='up triangle'>
        <input type='button' class='button' value='▽'  onmousedown="document.execCommand('insertText', false, '▽')"  title='down triangle'>
        <input type='button' class='button' value='▷'  onmousedown="document.execCommand('insertText', false, '▷')"  title='Forward triangle'>
        <br>
        <input type='button' class='button' value='⬅'  onmousedown="document.execCommand('insertText', false, '⬅')">
        <input type='button' class='button' value='⬌'  onmousedown="document.execCommand('insertText', false, '⬌')">
        <input type='button' class='button' value='➞'  onmousedown="document.execCommand('insertText', false, '➞')">
        <input type='button' class='button' value='⬆'  onmousedown="document.execCommand('insertText', false, '⬆')">
        <input type='button' class='button' value='⬍'  onmousedown="document.execCommand('insertText', false, '⬍')">
        <input type='button' class='button' value='⬇'  onmousedown="document.execCommand('insertText', false, '⬇')">
        <input type='button' class='button' value='⬈'  onmousedown="document.execCommand('insertText', false, '⬈')">
        <input type='button' class='button' value='⬉'  onmousedown="document.execCommand('insertText', false, '⬉')">
        <input type='button' class='button' value='⬊'  onmousedown="document.execCommand('insertText', false, '⬊')">
        <input type='button' class='button' value='⬋'  onmousedown="document.execCommand('insertText', false, '⬋')"> 
        <br>
        <input type='button' class='button' value='◻'  onmousedown="document.execCommand('insertText', false, '◻')"   title='BLACK SQUARE'>
        <input type='button' class='button' value='◼'  onmousedown="document.execCommand('insertText', false, '◼')"   title='WHITE SQUARE'>
        <input type='button' class='button' value='▢'  onmousedown="document.execCommand('insertText', false, '▢')">
        <input type='button' class='button' value='▣'  onmousedown="document.execCommand('insertText', false, '▣')">
        <input type='button' class='button' value='▤'  onmousedown="document.execCommand('insertText', false, '▤')">
        <input type='button' class='button' value='▥'  onmousedown="document.execCommand('insertText', false, '▥')">
        <input type='button' class='button' value='▦'  onmousedown="document.execCommand('insertText', false, '▦')">
        <input type='button' class='button' value='▧'  onmousedown="document.execCommand('insertText', false, '▧')">
        <input type='button' class='button' value='▨'  onmousedown="document.execCommand('insertText', false, '▨')">
        <input type='button' class='button' value='▩'  onmousedown="document.execCommand('insertText', false, '▩')">
        <br>
        <input type='button' class='button' value='◆'  onmousedown="document.execCommand('insertText', false, '◆')"   title='BLACK DIAMOND'>
        <input type='button' class='button' value='◇'  onmousedown="document.execCommand('insertText', false, '◇')"   title='WHITE DIAMOND'>
        <input type='button' class='button' value='⬤'  onmousedown="document.execCommand('insertText', false, '⏺')"   title='BLACK CIRCLE'>
        <input type='button' class='button' value='⭘'  onmousedown="document.execCommand('insertText', false, '⭘')"   title='WHITE CIRCLE'>
        <input type='button' class='button' value='◍'  onmousedown="document.execCommand('insertText', false, '◍')">
      </div>
    </div>
    <input type='button' class='button' value='𝗕'  onmousedown="document.execCommand('bold', false, null)"             title='Ctrl+B' style="padding-top:2px;">
    <input type='button' class='button' value='𝑰'  onmousedown="document.execCommand('italic', false, null)"           title='Ctrl+I' style="padding-top:2px;">
    <input type='button' class='button' value='𝐒'  onmousedown="document.execCommand('strikeThrough', false, null)" style='text-decoration: line-through;padding-top:2px;'>
    <input type='button' class='button' value='𝑿₂' onmousedown="document.execCommand('subscript', false, null)"                       style="padding-top:2px;">
    <input type='button' class='button' value='𝑿²' onmousedown="document.execCommand('superscript', false, null)"                     style="padding-top:2px;">
    <input type='button' class='button' value='❌' onmousedown="document.execCommand('removeFormat', false, null)"     title='Remove Format'>
    <input type='button' class='button' value='🔄' onmousedown="loadValue(CleanTextElem)"                              title='Load'>
    <input type='button' class='button' value='💾' onmousedown="saveValue(CleanTextElem)"                              title='Save'>
    <input type='button' class='button' value='p'  onmousedown="prompt('',CleanTextElem.innerHTML)"                    title='prompt'>
    <br>
    <div id="CleanText" contenteditable="true" class="textCleanerDiv" spellcheck="true" data-enable-grammarly="true" data-gramm="true"></div>

    <script>
        var globalCellObj = {};
        var CleanTextElem = document.getElementById('CleanText');
        function removeUnwantedNodes(elem){
          //remove highlights
          while (mark = elem.querySelector('mark')) 
            mark.outerHTML = mark.innerHTML;
          //remove case-sensitive search tool highlights
          while (span = elem.querySelector('span')) 
            span.outerHTML = span.innerHTML;
          //convert <div> to <br>
          while (div = elem.querySelector('div')) 
            div.outerHTML = div.innerHTML+'<br>';
          //convert <p> to <br>
          while (p = elem.querySelector('p')) 
            p.outerHTML = p.innerHTML+'<br>';
          //add an end <br>
          elem.innerHTML =  elem.innerHTML.replace(/(?:<br>|\s)*$/g, '<br> ')//+'<br> ';//document.createElement("p").innerHTML = //.replace(/(?:<br>|\s)*$/g, '<br>')
          
          return elem;
        }
        function loadValue(elem){
          google.script.run
          .withSuccessHandler(function(cellObj){
            globalCellObj = cellObj;
            elem.innerHTML = '<p>'+(cellObj.cellValue)+'</p>';
            formatText(CleanTextElem);
            formatText(CleanTextElem);
            })
          .getActiveCell();
        };
        function saveValue(elem){
          formatText(elem);
          //remove highlights
          removeUnwantedNodes(elem);
          google.script.run
            .withFailureHandler(showSnackbar("<b style='color:lightsalmon'>failed to save</b>"))
            .withSuccessHandler(showSnackbar('saved successfully'))
            .setActiveCellValue(JSON.stringify(globalCellObj), 
              elem.innerHTML
              .replace(/^<!--td.*-->|(?:<br>|\s)+$/g, '')
              .replace(/(?:\<br\>)*\s*[\n\r]+\s*/g, '<br>')
              .replace(/(?:&nbsp;|[\s\r\n\x0A])+/g,' ')
              .replace(/^(?:<br>|&nbsp;|[\s\r\n\x0A])+|(?:<b>(?:&nbsp;|[\s\r\n\x0A])*<\/b>)+|(?:<br>|&nbsp;|[\s\r\n\x0A])+$/g,'')
              .replace(/(?:(?:\s|<[bi]>)*<br>(?:\s|<[bi]>)*){2,}/g,'<br>')
            )
            highlightElem(elem);
        };
        window.onload = function () {
          CleanTextElem = document.getElementById('CleanText');
          
          loadValue(CleanTextElem);
          
          CleanTextElem.addEventListener("paste", function(e) {try{
            // cancel paste
            e.preventDefault();
            
            //get html representation of clipboard if there is html if not get text
            var html = e.clipboardData.getData('text/html');
            if (html) {
              // a temporary element
              var divElem = document.createElement('div');
              divElem.innerHTML = html;
              Array.from(divElem.getElementsByTagName('span')).forEach(elem=>{
                if (elem.style.fontFeatureSettings==='smcp' || elem.style.fontVariantCaps==='small-caps' || elem.style.fontVariant==='small-caps')
                  elem.outerHTML = elem.innerText.toUpperCase();
              });
              if (divElem.hasChildNodes()) {
                var cElems = divElem.childNodes;
                for (i = cElems.length; i>-1; --i)
                  if (elem = cElems[i])
                    if (elem.style)
                      if (elem.style.fontFeatureSettings==='smcp' || elem.style.fontVariantCaps==='small-caps' || elem.style.fontVariant==='small-caps')
                        elem.outerHTML = elem.innerText.toUpperCase();
              }

              //convert sub, sup, b, strong, em, italic elems to sth html nutral
              ['p','div','sub','sup','b','ul','li','td','th','tr','thead','tbody','table'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@'+tag+'@'+elem.innerHTML+'@|'+tag+'@';
              });
              ['h1','h2','h3','h4','h5','h6'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@p@@b@'+elem.innerHTML+'@|b@@|p@';
              });
              ['strong'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@b@'+elem.innerHTML+'@|b@';
              });
//              ['em','i'].forEach(function(tag){
//                while (elem = divElem.querySelector(tag)) 
//                  elem.outerHTML = (elem.innerHTML === 'n') ? elem.innerHTML : ('@i@'+elem.innerHTML+'@|i@');
//              });
              divElem.innerHTML = divElem.innerHTML.replace(/<br[^>]*?>/ig,'@br@');
              //prompt('',divElem.innerHTML);
              function atToHtml(txt) {
                var inlineElem = /(@(su[bp]|b|table|thead|th|tbody|tr|td|ul|li)@)(?!.*\1)(.*?)@\|\2@/g;
                var elemToBr = /(@(p|div)@)(?!.*\1)(.*?)@\|\2@/g;
                var br = /(?:\s*@br@\s*)+/g;
                txt = txt.replace(/&/g,'&amp;')
                         .replace(/</g,'&lt;')
                         .replace(/>/g,'&gt;')
                         .replace(/—/g,'&ndash;')
                         ;
                while(inlineElem.test(txt))
                 txt = txt.replace(inlineElem,'<$2>$3</$2>');
                while(elemToBr.test(txt))
                 txt = txt.replace(elemToBr,'$3<br>');
                while(br.test(txt))
                 txt = txt.replace(br,'<br>');
                txt = txt.replace(/^(?:<br>|[\s\n\r])+|(?:<br>|[\s\n\r])+$/g,'')
                          .replace(/(?:\s*<br>\s*)+/g,'<br>');
                return txt;
              }
              
              document.execCommand("insertHTML", false, atToHtml(divElem.innerText));
            } else {
              document.execCommand("insertHTML", false, e.clipboardData.getData('text/plain').replace(/^[\s\n\r]+|[\s\n\r]+$/g,''));
            }
          }catch(error){
            alert(error)
          }});
        };
    </script>
    <?!= include('shortcuts'); ?>
    <script>
    shortcut.add('Ctrl+.',function(){document.execCommand('superscript', false, null)});
    shortcut.add('Ctrl+,',function(){document.execCommand('subscript', false, null)});
    shortcut.add('Ctrl+m',function(){document.execCommand('insertText', false, 'µ')});
    shortcut.add('Ctrl+f12',function(){document.execCommand('insertText', false, '–')});
    shortcut.add('enter',function(){document.execCommand('insertHTML', false, '<br>')});
    shortcut.add('f2',function(){saveValue(CleanTextElem)});
    </script>
    
    <?!= include('snackBar'); ?>
  </body>
</html>
