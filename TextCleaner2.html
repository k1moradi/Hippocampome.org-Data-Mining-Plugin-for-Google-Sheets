<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
function highlightElem(elem){
  elem.innerHTML = elem.innerHTML
    .replace(/(\d(?:[\‚Äì '&]| \.|.\ | \. )\d|\d Mm|\\| \w \w |\bp[Mm]\b|\bMsec\b|\b[¬µgmM]m,?\b|,,|[\x01\x02\x03\x04\x05\x06\x07\x08ÔÅ°ÔÅ¢])/g, 
      "<mark class='hotPink'>$1</mark>")          // unautomatable mistakes
}
function formatText(elem) {
  elem = removeUnwantedNodes(elem);
  elem.innerHTML = elem.innerHTML
    .replace('‚ó¶','¬∞')//.replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&ndash;/g, '‚Äî')
    .replace(/[¬¨-][\r\n]+|^\s+|(?<=~)\s(?=\d)|(?<=\d[ ‚Äì-]m)\s+(?=s[ );,.])|(?<=\d)\s+(?=%)|(?<= o) (?=f[ ‚Äì])|(?<=SR) (?=95531)|(?<=CGP) (?=55845[ Aa]|52432)|(?<=¬µ) (?=M)|(?<=Œî) (?=F)|(?<=[ (]1) (?=st)|\u200B|, available at www.jneurosci. ?org ?as ?supplemental material/g,'')
    .replace(/(?<=[(;, ])([Ff]) *i *g *(s)? *\.(?=[ ),;.])/g                                                     , '$1ig$2.') // Fi g. -> Fig.
    .replace(/(?<=[(;, ]R) *(M) *(?=P[ ),;.])/gi                                                                 , '$1')      // R M P -> RMP
    .replace(/(?<!<br>)[\r\n]+|[\t\s]+|&nbsp;|&thinsp;|(?<=tables|table|figures|figure|figs\.|fig\.|figs|fig)(?=\w\w?[ \.\?;,)])(?!s[\. ]?)|(?<=[,;])(?=n=\d)|(?<= of)(?=‚Äì\d+)|(?<=\d+)(?=¬∞C)|(?<=GABA(?:.?(?:A|B|<sub>[AB]<\/sub>)))(?=\w)/ig,' ')
    .replace(/(?<=(?:tables|table|figures|figure|figs\.|fig\.|figs|fig) \w) (?=(?:<(i)>)?\w(?:<\/\1>)?[\‚Äì ,)<])/ig, '')       // Fig. 1 A -> Fig. 1A
    .replace(/(?<=[(;, ])([Tt])ruce(s)?(?=[ ),;.])/g                                                             , '$1race$2')
    .replace(/([iI])n *t *e *r? *[mn] *e *u *r *o *n(s*)/g                                                       , '$1nterneuron$2')
    .replace(/(?<=[(;, ])(Na|Cs|K|N)H *[2z,*] *P *[O0] *[4,](?=[ ),;.])/g                                        , '$1H‚ÇÇPO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *HP[O0] *4(?=[ ),;.])/g                                                , '$1‚ÇÇHPO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K)CH *3 *S *[O0] *4(?=[ ),;.])/g                                                 , '$1CH‚ÇÉSO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *[-‚Äî‚Äì] *[Pp]hosphocreatine(?=[ ),;.])/g                                , '$1‚ÇÇ-phosphocreatine')
    .replace(/(?<=[(;, ])(Na|Cs|K)H *C *[O0] *[3,](?=[ ),;.])/g                                                  , '$1HCO‚ÇÉ')
    .replace(/(?<=[(;, ])(Na|Cs|K) *3 *GTP(?=[ ),;.])/g                                                          , '$1‚ÇÉGTP')
    .replace(/(?<=[(;, ])(Na|Cs|K) *[2z,] *(G|A)TP(?=[ ),;.])/g                                                  , '$1‚ÇÇ$2TP')
    .replace(/(?<=[(;, ])(Ca|Mg|Ni|Co|Sr) *[CO][lI1] *[2z,](?=[ \/),;.])/g                                       , '$1Cl‚ÇÇ')  // O[1I] -> Cl
    .replace(/(?<=[(;, ])(H|Na|Cs|K) *[CO][I1](?=[ ),;.])/g                                                      , '$1Cl')   // O[1I] -> Cl
    .replace(/(?<=[(;, ])M *gS[O0] *4(?=[ ),;.])/g                                                               , 'MgSO‚ÇÑ')
    .replace(/(?<=[(;, ])(Na|Cs|K)MeS[O0] *3(?=[ ),;.])/g                                                        , '$1MeSO‚ÇÉ')//Methylsulfonate = Methanesulfonate
    .replace(/(?<=[(;, ])(Na|Cs|K)MeS[O0] *4(?=[ ),;.])/g                                                        , '$1MeSO‚ÇÑ')//Methylsulfate
    .replace(/(?<=[(;, ]|\.|\.\d)H *[2z,] *[O0](?=[ ),;.])/g                                                     , 'H‚ÇÇO')
    .replace(/(?<=[(;, ]|\.|\.\d)H‚ÇÇO\s*2(?=[ ),;.])/g                                                            , 'H‚ÇÇO‚ÇÇ')
    .replace(/(?<=[(;, \/])C *[O0] *[2z,?J](?=[ ),;.])/g                                                         , 'CO‚ÇÇ')
    .replace(/(?<=[(;, ])[O0] *[2z](?=[ +\/),;.‚Äì\-])/g                                                           , 'O‚ÇÇ')
    .replace(/(?<=[\[(\/;, ‚Äì-])Cl\s*[-‚àí"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ ‚Äì),;.\]])/g                        , 'Cl‚Åª')
    .replace(/(?<=[\[(\/;, ‚Äì-])(Na|K|Cs)\s*[+'"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ -‚Äì),;.\]])/g                , '$1‚Å∫')
    .replace(/(?<=[\[(\/;, ‚Äì-])(Mg|Ca|Sr)\s*[2\*]\s*[+'"\x01\x02\x03\x04\x05\x06\x07\x08](?=[ -‚Äì),;.\]])/g       , '$1¬≤‚Å∫')
    .replace(/\[\s*(Cl‚Åª|Cs‚Å∫|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\s*\]/g                                                             , '[$1]')    //[ Ca¬≤‚Å∫ ] -> [Ca¬≤‚Å∫]
    .replace(/(?<=[(;, ])\[(Cl‚Åª|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\]\s*[iI1](?=[ ),;.])/g                                         , '[$1]·µ¢')
    .replace(/(?<=[(;, ])\[(Cl‚Åª|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\]\s*[oO0](?=[ ),;.])/g                                         , '[$1]‚Çí')
    .replace(/(?<=[(;, ])\[(Cl‚Åª|Na‚Å∫|K‚Å∫|Mg¬≤‚Å∫|Ca¬≤‚Å∫)\]\s*[E](?=[ ),;.])/g                                           , '[$1]<sub>E</sub>')
    .replace(/(?<=[(;, ])et\s*a[1!]\.(?=[ ),;.])/g                                                               , 'et al.')
    .replace(/(?<=[\-‚Äì(;, ]|<br?>)C *A\s*[lI](?=[ ),;.])/g                                                       , 'CA1')     // lI as 1
    .replace(/(?<=[(;, ])C *A *([1-4])(?=[ ),;.])/g                                                              , 'CA$1')    // C A 1 -> CA1
    .replace(/(?<=[(;, ])([Ff]igs*|FIGS*)(\.*) *[lI]([A-Za-z]{0,2})(?=[ ),;.])/g                                 , '$1$2 1$3')// lI as 1
    .replace(/(?<=[(;,=><~‚â§‚â• ])(\d*)\s*[lI]\s*(\d+[.]\d+|\d+)(?<![(;,=><~‚â§‚â• ]I\d)(?=[ ),;.])/g                   , '$11$2')   // lI as 1
    .replace(/([(;, ].{1,3}[=><~‚â§‚â•])\s*(\d+\.\d+|\d+)\s*[lI]\s*(?=\d*[ ,;.)])/g                                  , '$1$21')   // lI as 1
    .replace(/(?<=[(;, ])(GABA)[-‚Äî‚Äì_ ]*[Aa](?=\s*-*\s*receptor|[ ),;.])/g                                        , '$1-A')    // GABA-A
    .replace(/(?<=[(;, ])(GABA)[-‚Äî‚Äì_ ]*[8Bb](?=\s*-*\s*receptor|[ ),;.])/g                                       , '$1-B')    // GABA-B
    .replace(/(?<=[(;, ])[od][-‚Äî‚Äì_ ]AP(V|5)(?=[ ),;.])/g                                                         , 'D-AP$1')
    .replace(/(?<=[(\/\d])(\s*mM\s*)?QX\s*[-‚Äì]?314(?=[ ),;.])/g                                                  , '$1QX314')
    .replace(/(?<=\d\s)mm(?=\s*(?:(?:Na{0,1}|C[als]|K|Mg|potassium|sodium|calcium|cesium|disodium)(?:¬≤‚Å∫|‚Å∫|‚Åª|(?:‚ÇÇH|H‚ÇÇ)PO‚ÇÑ|(?:CH‚ÇÉ|Me)*SO[‚ÇÉ‚ÇÑ]|[- ](?:phosphocreatine|gluconate)|HCO‚ÇÉ|[‚ÇÉ‚ÇÇ]*[GA]TP|Cl‚ÇÇ*|OH){0,1}[ ,;\/.)]|EGTA|[GA]TP|HEPES|QX.{0,1}314|TEA|glucose))|(?<=[(;, ]in )mm(?=[ ),;.])|(?<=QX‚Äì314 \(\d+ )mm(?=\))/g
                                                                                                                 , 'mM')
    .replace(/(?<=[(;, ])m M(?=[ ),;.])/g                                                                        , 'mM')
    .replace(/(?<=[(\d])\s*(?:mY|m V|mV)(?=[ ),;.])/g                                                            , ' mV')
    .replace(/(\d+(?:\.\d+)?)([^<>)(\d]?)(?:F[Li]?|l|[Uut]|\/[uxnijt\/\^]|[mg]u|I[Lt]|J\.*L|JI|j[af<iu]|[\(]i|\)\.l|i[xj]|p[\.Rut]|[!tl]J\.|[-~]t|,u\.?|#¬£|\|x|[g√¨\x01\x02\x03\x04\x05ÔÅ≠\^])\s*([MmsA]|m2|rn|[Ss]ec)(?<!gm)(?=[ ),;.‚Äì]|.thick)/g,
      function(fullMatch,p1,p2,p3){
        return p1+((p2)?p2:' ')+'¬µ'+((p3 === 'm2')?'m¬≤':((p3==='rn')?'m':p3))})                                               //¬µM
    .replace(/(?<=[(\d])\s*(?:[pP]|\|x)(M)(?=[ ),;.])/g                                                          , ' ¬µ$1')    //¬µM ¬µV not PV+
    .replace(/(?<=[(;, ])(\d+)\s*[\-‚Äì]?\s*(?:[pP]m)(?=‚Äìthick[ ),;.])/g                                           , '$1‚Äì¬µm')   //\d-pm-thick -> \d-¬µm-thick
    .replace(/\|/g                                                                                               , 'I')
    .replace(/(?<=[(\d])\s*[\x01\x02\x03\x04\x05]\s*([tT])(?=[ ),;.])/g                                          , ' Œî$1')
    .replace(/(?<=\d)\s√í/g                                                                                       , ' M')
    .replace(/(?<=[\(\s])CV\s*[\x01\x02\x03\x04\x05\x06\x07-‚àí]\s*2(?=[\s\)])/g                                  , 'CV‚Åª¬≤')
    .replace(/(?<=\s)1[\/]CV 2(?=\s)/g                                                                           , '1/CV¬≤')
    .replace(/(?<=\d)\s*mm\s*2(?=[\s,])/g                                                                        , ' mm¬≤')
    .replace(/(?<=\s)(mS|kg)?[\s¬∑]?([cm])(?:m|rr)\s*[\-‚ÄìT]\s*2(?=[\s,])/g                                        , '$1 $2m‚Åª¬≤')// cm‚Åª¬≤
    .replace(/(?<=\d)\s*o\/o(?=[ ),;.])/g                                                                        , '%')
    .replace(/(?<=[\s¬∑])(min|m‚ãÖ?[gsL]|[¬µc]m)\s*[-‚Äì]\s*1(?=[\s)])/g                                                , '$1‚Åª¬π')
    .replace(/w√èv/g                                                                                              , 'w/v')
    .replace(/Ô¨Å/g                                                                                                , 'fi')
    .replace(/[\x01\x02\x03\x04\x05\x06\x07\x08](?=.?aminobutyric acid)/ig                                       , 'Œ≥')       // Œ≥-aminobutyric acid
    .replace(/Greek Letter Mu|&micro;\s*|Œº|&mu;/g                                                                , '¬µ')       // ALT+230 convert unicode to ascii
    .replace(/&tau;|(?:(?<= )\\?tau|(?<=(?:time constants?|decay|rise) ?\(?)(?:tau|[\x01\x02\x03\x04\x05\x06\x07\x08]))(?=[ =),;.])/ig
                                                                                                                 ,'œÑ')        // ALT+231
    .replace(/omega([^<>)(]{0,1}(?:aga|cono)toxin)/g                                                             , 'œâ$1')
    .replace(/(?<=[(;, ])[\(\{]\}(?=[\- ),;.])/g                                                                 , 'Œ∏')
    .replace(/(?<=\d)\s*[¬∑*]\s*(?=\d)|(?<=[ ¬±+‚Äì]0)‚Äì?(?=(?:0\d+|[1-9])[ ¬±+])/g                                    , '.')       // decimal point  |(?<=[ +=]\d)[‚Äì'](?=\d+[ +])
    .replace(/(?<=[ =,;(]\d+)[‚Äì'&.](\d+)\s*([+¬±‚Äì])\s*(\d+)[‚Äì'&.](?=\d+[ ),;])/g                                  , '.$1$2$3.')//\d‚Äì\d‚Äì\d‚Äì\d --> \d.\d‚Äì\d.\d)
    .replace(/(?<=[A-Za-z])\s*[-‚àí](\s*)(?=[A-Za-z])/g                                                            , '-$1')     // negative as hiphen between two words
    .replace(/(?<=[\w¬π¬≤¬≥‚ÇÇ‚ÇÉ‚ÇÑ‚Å∫‚ÅªŒ±√ü¬µœÑŒîŒ©Œ≥\)])[‚Äì‚Äî‚àí-](?=[\w¬π¬≤¬≥‚ÇÇ‚ÇÉ‚ÇÑ‚Å∫‚ÅªŒ±√ü¬µœÑŒîŒ©Œ≥\(])/g                                         , '‚Äì')       // normal hiphen as big hiphen or negative signs between two words
    .replace(/(?<=[(;, ])(?:<(i)>)?\s*t\s*(?:<\/\1>)?\s*test|(?<=paired)‚Äìt test/ig                               , ' t‚Äìtest')  // t‚Äìtest
    .replace(/&minus;|(?<= [‚àº(]|>\(?|\d+\/) *[‚Äì‚Äî‚àí](?=\d)|(?<=[(;, ])[‚Äì‚Äî‚àí](?=\d+[‚Äì ]ms|\d+\/\d+ )/g               , '-')       // ngative
    .replace(/(?<=[\d])\s*(?:[‚Äì‚Äî‚àí]|&ndash;)\s*(\d+)\s*(?=%)/g                                                    , '-$1')     // 20-80%
    .replace(/(?<=[(;, ])[I1]‚Äì0(?=[ ),;.])/g                                                                     , 'I-O')
    .replace(/(?<=[(;, ])[n¬´]\s*(?:[¬º\x01\x02\x03\x04\x05\x06\x07\x08]*| -|=)\s*(?=\d+[ ),;.])/g                 , 'n=')
    .replace(/(?<=[(;, ])([pP])\s*[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=0*\.0(5|1|01)[ ),;.])/g                , '$1<')
    .replace(/(?<=[(;, ])([pP])\s*[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?!0*\.0(5|1|01))(?=0*\.0\d+[ ),;.])/g    , '$1=')
    .replace(/(?<=\<\/sub>)\s*[\x01\x02\x03\x04\x05\x06\x07\x08](?=[ ),;.])/g                                    , '=')
    .replace(/plusminus|&plusmn;/g                                                                               , '¬±')
    .replace(/(?<=[(;, >=])([\-‚àí+]?\d+(?:\.\d+)?)(?<!55845|95531|314|222)\s*(.?Œ©|[¬µŒº].?|¬∞C|m[MVs]|m[lL].?min|[pn][ASF]|Hz|%)*\s*(?:[¬±+\x01\x02\x03\x04\x05\x06\x07\xAD]|\+\/-)\s*(?=\d+(?:\.\d+)?[ )%,;¬∞.<])/g
                                                                                                                 , '$1$2¬±')   //\d ¬± \d  -> \d¬±\d
    .replace(/(?<=[(;, >=])([\-‚àí+]?\d+(?:\.\d+)?)(?<!55845|95531|314|222)\s*(.?Œ©|[¬µŒº].?|¬∞C|m[MVs]|m[lL].?min|[pn][ASF]|Hz|%)*\s+(?:[64i]-?|:E)\s+(?=\d+(?:\.\d+)?[ )%,;¬∞.<])/g
                                                                                                                 , '$1$2¬±')   //\d 64i \d  -> \d¬±\d
    .replace(/([(;, \][\/])([Mm]eans?|MEANS?)\s*(?:[¬±+6\x01\x02\x03\x04\x05\x06\x07\xAD]|\+\/-)\s*(?=[Ss][\.\/]?[EeDd]\.?[Mm]?)/g
                                                                                                                 , '$1$2¬±')   // Mean ¬± SEM --> Mean¬±SEM
    .replace(/(?<=[A-Za-z=,(])(\s*)[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=[5-8][05][ ),;.])/g                   , '$1-')     // control character as negative sign for values <-50
    .replace(/(?<=[A-Za-z=,(])(\s*)[\x01\x02\x03\x04\x05\x06\x07\x08]\s*(?=\d+[¬±.]\d+[ ),;.¬±])/g                 , '$1-')     // control character as negative sign between a word and a number with decimals
    .replace(/(?<=[=><(‚â§‚â•~ ])(\s*)[‚Äì‚Äî‚àí]\s*(?=(?:\d+[.]\d+|\d+)[ ),;.¬±])/g                                        , '$1-')     // hiphen as negative sign
    .replace(/(?<=\w[(;, ])(\s*(?:[~+\-><‚âà]|&[lg]t;))\s(?=(?:\d+[.]\d+|\d+)[ ),;.¬±%])/g                          , '$1')      // [~+-><]\s\d
    .replace(/approx(?=\d)/g                                                                                     , '~')
    .replace(/(?<=\w)\s*[(]\s(?=-{0,1}[\wŒî¬µ])/g                                                                  , ' (')
    .replace(/(?<=[\w\dŒ©])\s[)]\s*(?=[:.,;])/g                                                                   , ')')
    .replace(/(?<=[\w\dŒ©%])(?<!phenoxy)\s*[)]\s*(?=[\w])(?!ethane)/g                                             , ') ')
    .replace(/(?<=[\w¬π¬≤‚ÇÇ‚ÇÉ‚ÇÑŒ©>])(?<![-,]N|&amp|&lt|&gt|&ndash|&plusmn|&minus|&tau)\s+([,;])\s*(?=[A-Za-z]|\d+\.?\d* )(?!N,|-tetraacetic)/g
                                                                                                                 ,'$1 ')      // space after ,;
    .replace(/(?<=[(;, ]\d+(?:\.\d+)?)\s+%\s*(?=[A-Za-z]|\d+(?:\.\d+)?[ ),;.¬±])/g                                ,'% ')       // remove space before %
    .replace(/\s*(?:=<(?!(?:sub|s|i|b|br|em|div|strong)>)|<=)\s*/g                                               , '‚â§')
    .replace(/(?<=sub|s|i|b|em|br|div|strong)(?!>=)> *= *(?=\d)/g                                                , '>=')
    .replace(/(?:=(?:>|&gt;)|(?:&gt;|(?<!<\/?(?:su[bp]|[sib]|em|br|div|strong))>)=)\s*/g                         , '‚â•')       // of ‚â•1
    .replace(/-->/g                                                                                              , '‚ûû')
    .replace(/<--/g                                                                                              , '‚¨Ö')
    .replace(/<->/g                                                                                              , '‚¨å')
    .replace(/(?<!\..)(?<=[\w‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Çô‚Çò‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ)])\s*\.\s*(?=[a-zA-z]+\s)/g                                     , '. ')
    .replace(/\s*\.+\s*$/g                                                                                       , '.')
    .replace(/(?<=[(;, ])V *(amp|hold(?:ing)?|thresh*)(?=[ =),;.])/ig                                            , 'ùëâ<sub>$1</sub>')
    .replace(/(?<=[(;, ])(?:[trœÑ]|tau) *(D|d|R|decay|rise)(?=[ =),;.])/g                                         , 'œÑ<sub>$1</sub>')
    .replace(/(?<=[(;, ‚Äì])([EI]) *(K|Na|C[lsa]|rev|GABA)(?=[ =),;.])/g                                           ,'$1<sub>$2</sub>')
    .replace(/(?<=[(\d])\s*([GM])\s*(?:[√ôQ\x01\x02\x03\x04\x05\x06\x07ÔÅóO~]|[Oo]mega|[St1I]2|IL|il|f[lit~]|tl)(?=[ ),;.])/g
                                                                                                                 ,' $1Œ©')
    .replace(/(?<=[(;, ]R)(?:m|,,|[,l] ?n)(?=,? \d+(?:\.\d+)?(?:¬±\d+\.?\d*)? MŒ©)|(?<=input resistance\s*[(;, ]R)(?:m|,,|[,l] ?n)/g
                                                                                                           ,  '<sub>in</sub>')// R,, -> Rin
    .replace(/(?<=[(;, ])R *([Ss]|in|IN|input)(?=[ =),;.])/g                                               , 'R<sub>$1</sub>')// Rin Rs
    .replace(/(?<=[(;, ])C *([mM])(?=[ =),;.])/g                                                           , 'C<sub>$1</sub>')// Cm --> C‚Çò  [not cm = centimiter]
    .replace(/(?<=(?:[A-Za-z]{3}|[)])\s*\d+(?:,\d+)*)\s*'\s*(?=\d+(?:\s\(|[.,]\s|\.$|\.<br>))/g            , ',')             // numerical references miss spelling \d'\d -> \d,\d
    .replace(/(?<=[A-Za-z]{3}|[)])(?<![Ff]ig(?:ure|s?\.)?s?|[Tt]ables?|<br>)(?![,\d\s]*(?:and|\(\d{4}\)))\s*(\d{1,2}(?:,\s*\d{1,2})+)(?=\s\(|[.,]\s|\.$|\.<br>)/g
                                                                                                            ,'<sup>$1</sup>') // numerical references during 1, 5, 10, and 20 Hz
    .replace(/(?:((?<=[(;, ])(?:ms|min|sec|¬µm|œá)|\^)([-‚Äì‚àí]*\s*\d+(?:\.\d+)*(?!‚Äì))|(?<!alexa|prox|and|was|[Tt]able|[Ff]igure|paradigm|cell|neuron|actinin|GAD)(?<=[a-z]{3}|[)])\s*([\d‚Äì]{1,3})(?=\.(?:\s|<br>)|\.$))/g, 
      function(fullMatch,p1,p2,p3){
        var prefix = ((p1 === '^' || !p1) ? '' : p1)
        var num = Array.from((p2)?p2:p3).reduce(
          function(num,digit){
            switch (digit) {
              case "0": return num+'‚Å∞'; break;
              case "1": return num+'¬π'; break;
              case "2": return num+'¬≤'; break;
              case "3": return num+'¬≥'; break;
              case "4": return num+'‚Å¥'; break;
              case "5": return num+'‚Åµ'; break;
              case "6": return num+'‚Å∂'; break;
              case "7": return num+'‚Å∑'; break;
              case "8": return num+'‚Å∏'; break;
              case "9": return num+'‚Åπ'; break;
              case "-": return num+'‚Åª'; break;
              case "‚Äì": return num+'‚Åª'; break;
              case "‚àí": return num+'‚Åª'; break;
              case ".": return num+'‚ãÖ'; break;
              default : return num; break;
          }
        },'');
        return prefix+num
      })                                                                                                                        //¬µm¬≤
    .replace(/((?<=[\/(;, ])[vrœÑ]|[esmu]{0,1}\.{0,1}[ei]\.{0,1}p\.{0,1}s\.{0,1}[cp]|_)(\d+|\s\d|\s*[nmhi])(?<!c57|CI|RI)(?=[ =\/),;.+](?!ANOVA)|\s*<\/)/ig, //RI = Resistance Internal != Rectification Index
      function(fullMatch,p1,p2){
        var prefix = ((p1 === '_') ? '' : p1);
        var num = Array.from(p2).reduce(
          function(num,digit){
            switch (digit) {
              case "0": return num+'‚ÇÄ'; break;
              case "1": return num+'‚ÇÅ'; break;
              case "2": return num+'‚ÇÇ'; break;
              case "3": return num+'‚ÇÉ'; break;
              case "4": return num+'‚ÇÑ'; break;
              case "5": return num+'‚ÇÖ'; break;
              case "6": return num+'‚ÇÜ'; break;
              case "7": return num+'‚Çá'; break;
              case "8": return num+'‚Çà'; break;
              case "9": return num+'‚Çâ'; break;
              case "n": return num+'‚Çô'; break;
              case "N": return num+'<sub>N</sub>'; break;
              case "m": return num+'‚Çò'; break;
              case "M": return num+'<sub>M</sub>'; break;
              case "h": return num+'‚Çï'; break;
              case "H": return num+'<sub>H</sub>'; break;
              case "i": return num+'·µ¢'; break;
              case "I": return num+'<sub>I</sub>'; break;
              default : return num; break;  // removes space
            }
          },'');
        return prefix+num
      })                                                                                                                        //œÑ‚ÇÅ PSC‚ÇÅ
    .replace(/(?<=[(;, ])(\w+(?:<su[bp]>\w+<\/su[bp]>|[‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ‚Çï·µ¢‚Çò‚Çô‚Çí])*(?:[:\/\+\-]\w+(?:<su[bp]>\w+<\/su[bp]>|[‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ‚Çï·µ¢‚Çò‚Çô‚Çí])*)*|\[\w\w¬≤{0,1}[‚Åª‚Å∫]\][·µ¢‚Çí]{0,1})\s([><¬±‚â§‚â•])\s*(?=[-+]{0,1}\d)/g
                                                                                                                 , '$1 $2')     //[><‚â§‚â•¬±] \d --> [><‚â§‚â•¬±]\d //[^aI ]|[^awhumboie ][^lenyfptio ]|sub>
    .replace(/(PV|CB1{0,1}|CR|CCK|SOM|VIP)\s([+-])/g                                                             , '$1$2')      // PV +/CCK + BC --> PV+/CCK+ BC, 
    .replace(/(?<=[(;, \]\/])(sub>|[Œ±√üŒ≥Œ¥ŒµŒ∂Œ∑Œ∏ŒªŒ∫Œ∂Œæ¬µœÅœÑœÄœÜœáœàœâœÉ‚àÜŒ©\w‚ÇÄ‚ÇÅ‚ÇÇ‚ÇÉ‚ÇÑ‚ÇÖ‚ÇÜ‚Çá‚Çà‚Çâ‚Å∞¬π¬≤¬≥‚Åµ‚Å∂‚Å∑‚Å∏‚Åπ‚Çï·µ¢‚Çò‚Çô]+)\s*([=])\s*(?=[-+]{0,1}\d)/g , '$1$2')      // word = \d --> word=\d
    .replace(/(?<=[(;, \]\/])(\**p)\s*([<>‚â§‚â•]|&lt;|&gt;)\s*(?=-{0,1}\d)/gi                                       , '$1$2')      // p < \d --> p<\d
    .replace(/(?<=[(;, ][ABD])\s*[Il](?=[ ),;.])/g                                                               , '1')         // B [Il] -> B1
    .replace(/\s+\<(br|\/td)>/g                                                                                  , '<$1>')
    .replace(/\s+<\/(br?)>/g                                                                                     , '</$1> ')
    .replace(/(^[\-‚Äì \w]{1,100}? )([Aa](?: and [Bb]){0,1},)(?= )/                                          , '<b>$1</b><br>$2') // bold the first sentence of the images
    .replace(/((?:<br>\s*|(?<![Ff]igs?|[Rr]efs?|vs|et[ .]?al|\(\w{1,2})\.\s)(?:(?=\([^.):]{1,20}[):]|\w (?:and|or) \w,)|(?!\w{1,3}[\. ]|\(|<b>[^.,:<>]{1,20}<\/b> )))(\(?(?:(?:\w[a-z1-9]?|<b>\w[a-z1-9]?:?<\/b>)(?:(?:[,\-‚Äì ]{1,2}|and|or){1,3}(?:\w[a-z1-9]?|<b>\w[a-z1-9]?:?<\/b>)){0,2}|<b>\w[a-z1-9]?(?:(?:[,\-‚Äì ]{1,2}|and|or){1,3}\w[a-z1-9]?){0,2}:?<\/b>)(?:(?<=:<\/b>)|[\),:]|(?<=(?:and|or) \w[a-z1-9]?)))(?= )/g,
      function(fullMatch,p1,p2){
        return ((p1==='. ')?'.':'')+'<br><b>'+p2.replace(/<\/?b>/g,'')+'</b>';                                      })          // a-b, bold image list                                                                                                                        
    .replace(/(?<=[\.;]\s|<\/?br?>)(\s*(?:(?:right|left|top|bottom|middle|center|insets?|upper|lower|abbreviations?)(?:(?:\s+to\s+|\s+)?(?:panel|graph|trace|left|right|top|bottom|middle|center))?[,:]\s*)+)(?=\s)/ig,' <b>$1</b>') // bold subsections in figures
    .replace(/^([^.,?<>]+\.)\s*(?=<br>)/g                                                                        , '<b>$1</b>') // bold the 1st sentence
    .replace(/(?<!<\/b>)(?:<br>)([\w ]*?\.)(?:(?:<br>(?!<b>)))/g                                         , '<br><b>$1</b><br>') // bold subsections
    .replace(/(?:[\n\s]*(?:<br>)+(?!\n)|(?:<br>)+\n+)/g                                                          , '<br>')
    .replace(/<\/b>\s*<b>/g                                                                                      , ' ')
    .replace(/ *> +< */g                                                                                         , '><')
    //.replace(/<p>/g                                                                                              , '&lt;p&gt;')
    .replace(/(\d)\s*\/\s*(\d)(?<!\d\/\d)/g                                                                      ,'$1/$2')      //remove spaces between numbers and /
    .replace(/^(?:[ .?!)}\]\xAD]+|<br>)+(?=\w|<b>)/g                                                             , '');         //remove spaces from the begining of quote
    highlightElem(elem);
    if (typeof elem.forceSpellCheck === 'function') elem.forceSpellCheck();
};
    </script>
    <style>
      body {
        margin: 0px;
        background-color: #e8eaf6;
      }
      .textCleanerDiv {
        width: calc(100vw - 0px);
        height: calc(100vh - 26px);
        padding: 1px;
        font-family: Verdana, Arial, Helvetica, sans-serif;/*'Open Sans', sans-serif;*/
        font-size: 16px;
        //letter-spacing: 1px;
        line-height: 1.5em;
        display: block;
        position: absolute;
        margin: 0;
        border: 2px solid #74637f;
        border-radius: 0;
        color: black;
        background-color: white;
        overflow: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
        display:inline-block;/* contenteditable elem will not generate div, p and span automatically in Chrome.*/
      }
      .textCleanerDiv br {
        line-height:200%;
      }
      .textCleanerDiv sup {
        font-size: 58%;
        font-weight: bold;
        vertical-align: 20%;
      }
      .textCleanerDiv table {
        /*font-size:1.2vw;*/
        word-break:break-word;
        border-collapse: collapse;
      }
      .textCleanerDiv th, .textCleanerDiv td {
        border: 1px solid #ddd;
      }
      .textCleanerDiv th, .textCleanerDiv thead {
        position: sticky;
        background-color:#2b2727de;
        color:white;
      }
      .textCleanerDiv tr:nth-child(even){
        background-color: #f2f2f2;
      }
      .textCleanerDiv tr:hover {
        background-color: #ddd;
      }
      input {
        height:20px;
        /*width:19px;*/
      }
      .hotPink{
        background-color:hotpink;
      }
    </style>
    <?!=include('commonCSS')?>
  </head>
  <body>
    <title>PDF Text Cleaner Tool</title>
    <input   type='button' class='button' value='‚úç' onmousedown='formatText(CleanTextElem)'                          title='Format: Shortcut=F2'>
    <div class="dropdown">
      <input   type='button' class='button' value='üî£'>
      <div class="dropdown-content">
        <input type='button' class='button' value='‚åÇ'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().replace(/ /g, ''))" title='remove all spaces of selected text'>
        <input type='button' class='button' value='üÜÑ'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().toUpperCase());" title='UpperCase selected text'>
        <input type='button' class='button' value='üÖª'  onmousedown="document.execCommand('insertText', false, document.getSelection().toString().toLowerCase());" title='LowerCase selected text'>

        <input type='button' class='button' value='¬∞'  onmousedown="document.execCommand('insertText', false, '¬∞')"   title='degree'>
        <input type='button' class='button' value='¬±'  onmousedown="document.execCommand('insertText', false, '¬±')"   title='plus minus'>
        <input type='button' class='button' value='√ó'  onmousedown="document.execCommand('insertText', false, '√ó')"   title='multiply'>
        <input type='button' class='button' value='‚àö'  onmousedown="document.execCommand('insertText', false, '‚àö')"   title='root square'>
        <input type='button' class='button' value='‚àë'  onmousedown="document.execCommand('insertText', false, '‚àë')"   title='Zigma'>
        <input type='button' class='button' value='‚âà'  onmousedown="document.execCommand('insertText', false, '‚âà')"   title='almost equal to'>

        <input type='button' class='button' value='Œ¶'  onmousedown="document.execCommand('insertText', false, 'Œ¶')"   title='Phi Capital'>
        <input type='button' class='button' value='œà'  onmousedown="document.execCommand('insertText', false, 'œà')"   title='Psi Capital'>
        <input type='button' class='button' value='œÉ'  onmousedown="document.execCommand('insertText', false, 'œÉ')"   title='Sigma Capital'>
        <input type='button' class='button' value='Œî'  onmousedown="document.execCommand('insertText', false, 'Œî')"   title='Delta Capital'>
        <input type='button' class='button' value='Œ©'  onmousedown="document.execCommand('insertText', false, 'Œ©')"   title='Omega Capital'>
        <br>
        <input type='button' class='button' value='Œ±'  onmousedown="document.execCommand('insertText', false, 'Œ±')"   title='alpha Minuscule'>
        <input type='button' class='button' value='√ü'  onmousedown="document.execCommand('insertText', false, '√ü')"   title='beta Minuscule'>
        <input type='button' class='button' value='Œ≥'  onmousedown="document.execCommand('insertText', false, 'Œ≥')"   title='gamma Minuscule'>
        <input type='button' class='button' value='Œ¥'  onmousedown="document.execCommand('insertText', false, 'Œ¥')"   title='delta Minuscule'>
        <input type='button' class='button' value='Œµ'  onmousedown="document.execCommand('insertText', false, 'Œµ')"   title='epsilon Minuscule'>
        <input type='button' class='button' value='Œ∂'  onmousedown="document.execCommand('insertText', false, 'Œ∂')"   title='zeta Minuscule'>
        <input type='button' class='button' value='Œ∑'  onmousedown="document.execCommand('insertText', false, 'Œ∑')"   title='eta Minuscule'>
        <input type='button' class='button' value='Œ∏'  onmousedown="document.execCommand('insertText', false, 'Œ∏')"   title='theta Minuscule'>
        <input type='button' class='button' value='Œ∫'  onmousedown="document.execCommand('insertText', false, 'Œ∫')"   title='kappa Minuscule'>
        <input type='button' class='button' value='Œª'  onmousedown="document.execCommand('insertText', false, 'Œª')"   title='lamda Minuscule'>
        <input type='button' class='button' value='¬µ'  onmousedown="document.execCommand('insertText', false, '¬µ')"   title='mu Minuscule, shortcut:Ctrl+M'>
        <input type='button' class='button' value='Œæ'  onmousedown="document.execCommand('insertText', false, 'Œæ')"   title='xi Minuscule'
        ><input type='button' class='button' value='œÄ'  onmousedown="document.execCommand('insertText', false, 'œÄ')"   title='pi Minuscule'
        ><input type='button' class='button' value='œÅ'  onmousedown="document.execCommand('insertText', false, 'œÅ')"   title='rho Minuscule'
        ><input type='button' class='button' value='œÉ'  onmousedown="document.execCommand('insertText', false, 'œÉ')"   title='sigma Minuscule'
        ><input type='button' class='button' value='œÑ'  onmousedown="document.execCommand('insertText', false, 'œÑ')"   title='tau Minuscule'
        ><input type='button' class='button' value='œÜ'  onmousedown="document.execCommand('insertText', false, 'œÜ')"   title='phi Minuscule'
        ><input type='button' class='button' value='œá'  onmousedown="document.execCommand('insertText', false, 'œá')"   title='chi Minuscule'
        ><input type='button' class='button' value='œà'  onmousedown="document.execCommand('insertText', false, 'œà')"   title='psi Minuscule'
        ><input type='button' class='button' value='œâ'  onmousedown="document.execCommand('insertText', false, 'œâ')"   title='Omega Minuscule'>
        <br>
        <input type='button' class='button' value='‚Å∞'  onmousedown="document.execCommand('insertText', false, '‚Å∞')"   title='Superscript'>
        <input type='button' class='button' value='¬π'  onmousedown="document.execCommand('insertText', false, '¬π')"   title='Superscript'>
        <input type='button' class='button' value='¬≤'  onmousedown="document.execCommand('insertText', false, '¬≤')"   title='Superscript'>
        <input type='button' class='button' value='¬≥'  onmousedown="document.execCommand('insertText', false, '¬≥')"   title='Superscript'>
        <input type='button' class='button' value='‚Å¥'  onmousedown="document.execCommand('insertText', false, '‚Å¥')"   title='Superscript'>
        <input type='button' class='button' value='‚Åµ'  onmousedown="document.execCommand('insertText', false, '‚Åµ')"   title='Superscript'>
        <input type='button' class='button' value='‚Å∂'  onmousedown="document.execCommand('insertText', false, '‚Å∂')"   title='Superscript'>
        <input type='button' class='button' value='‚Å∑'  onmousedown="document.execCommand('insertText', false, '‚Å∑')"   title='Superscript'>
        <input type='button' class='button' value='‚Å∏'  onmousedown="document.execCommand('insertText', false, '‚Å∏')"   title='Superscript'>
        <input type='button' class='button' value='‚Åπ'  onmousedown="document.execCommand('insertText', false, '‚Åπ')"   title='Superscript'>
        <input type='button' class='button' value='‚Å∫'  onmousedown="document.execCommand('insertText', false, '‚Å∫')"   title='Superscript'>
        <input type='button' class='button' value='‚Åª'  onmousedown="document.execCommand('insertText', false, '‚Åª')"   title='Superscript'>
        <input type='button' class='button' value='‚Åº'  onmousedown="document.execCommand('insertText', false, '‚Åº')"   title='Superscript'>
        <input type='button' class='button' value='‚ÅΩ'  onmousedown="document.execCommand('insertText', false, '‚ÅΩ')"   title='Superscript'>
        <input type='button' class='button' value='‚Åæ'  onmousedown="document.execCommand('insertText', false, '‚Åæ')"   title='Superscript'>
        <input type='button' class='button' value='·µÖ'  onmousedown="document.execCommand('insertText', false, '·µÖ')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·µù'  onmousedown="document.execCommand('insertText', false, '·µù')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·µû'  onmousedown="document.execCommand('insertText', false, '·µû')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·µü'  onmousedown="document.execCommand('insertText', false, '·µü')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·∂ø'  onmousedown="document.execCommand('insertText', false, '·∂ø')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·∂•'  onmousedown="document.execCommand('insertText', false, '·∂•')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·µ†'  onmousedown="document.execCommand('insertText', false, '·µ†')"   title='Superscript Minuscule'>
        <input type='button' class='button' value='·µ°'  onmousedown="document.execCommand('insertText', false, '·µ°')"   title='Superscript Minuscule'>
        <br>
        <input type='button' class='button' value='‚ÇÄ'  onmousedown="document.execCommand('insertText', false, '‚ÇÄ')"   title='Subscript'>
        <input type='button' class='button' value='‚ÇÅ'  onmousedown="document.execCommand('insertText', false, '‚ÇÅ')"   title='Subscript'>
        <input type='button' class='button' value='‚ÇÇ'  onmousedown="document.execCommand('insertText', false, '‚ÇÇ')"   title='Subscript'>
        <input type='button' class='button' value='‚ÇÉ'  onmousedown="document.execCommand('insertText', false, '‚ÇÉ')"   title='Subscript'>
        <input type='button' class='button' value='‚ÇÑ'  onmousedown="document.execCommand('insertText', false, '‚ÇÑ')"   title='Subscript'>
        <input type='button' class='button' value='‚ÇÖ'  onmousedown="document.execCommand('insertText', false, '‚ÇÖ')"   title='Subscript'>
        <input type='button' class='button' value='‚ÇÜ'  onmousedown="document.execCommand('insertText', false, '‚ÇÜ')"   title='Subscript'>
        <input type='button' class='button' value='‚Çá'  onmousedown="document.execCommand('insertText', false, '‚Çá')"   title='Subscript'>
        <input type='button' class='button' value='‚Çà'  onmousedown="document.execCommand('insertText', false, '‚Çà')"   title='Subscript'>
        <input type='button' class='button' value='‚Çâ'  onmousedown="document.execCommand('insertText', false, '‚Çâ')"   title='Subscript'>
        <input type='button' class='button' value='‚Çä'  onmousedown="document.execCommand('insertText', false, '‚Çä')"   title='Subscript'>
        <input type='button' class='button' value='‚Çã'  onmousedown="document.execCommand('insertText', false, '‚Çã')"   title='Subscript'>
        <input type='button' class='button' value='‚Çå'  onmousedown="document.execCommand('insertText', false, '‚Çå')"   title='Subscript'>
        <input type='button' class='button' value='‚Çç'  onmousedown="document.execCommand('insertText', false, '‚Çç')"   title='Subscript'>
        <input type='button' class='button' value='‚Çé'  onmousedown="document.execCommand('insertText', false, '‚Çé')"   title='Subscript'>
        &nbsp;
        <input type='button' class='button' value='·µ¶'  onmousedown="document.execCommand('insertText', false, '·µ¶')"   title='Subscript Capital'>
        <input type='button' class='button' value='·µß'  onmousedown="document.execCommand('insertText', false, '·µß')"   title='Subscript Capital'>     
        &nbsp;
        <input type='button' class='button' value='·µ®'  onmousedown="document.execCommand('insertText', false, '·µ®')"   title='Subscript Miniscule Rho'>
        &nbsp;
        <input type='button' class='button' value='·µ©'  onmousedown="document.execCommand('insertText', false, '·µ©')"  title='Subscript Capital'>
        <input type='button' class='button' value='·µ™'  onmousedown="document.execCommand('insertText', false, '·µ™')"  title='Subscript Capital'>
        <br>
        <input type='button' class='button' value='·¥¨'  onmousedown="document.execCommand('insertText', false, '·¥¨')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥Æ'  onmousedown="document.execCommand('insertText', false, '·¥Æ')"  title='Superscript Capital'>&thinsp;
        <input type='button' class='button' value='·¥∞'  onmousedown="document.execCommand('insertText', false, '·¥∞')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥±'  onmousedown="document.execCommand('insertText', false, '·¥±')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥≥'  onmousedown="document.execCommand('insertText', false, '·¥≥')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥¥'  onmousedown="document.execCommand('insertText', false, '·¥¥')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥µ'  onmousedown="document.execCommand('insertText', false, '·¥µ')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥∂'  onmousedown="document.execCommand('insertText', false, '·¥∂')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥∑'  onmousedown="document.execCommand('insertText', false, '·¥∑')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥∏'  onmousedown="document.execCommand('insertText', false, '·¥∏')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥π'  onmousedown="document.execCommand('insertText', false, '·¥π')"  title='Superscript Capital'> 
        <input type='button' class='button' value='·¥∫'  onmousedown="document.execCommand('insertText', false, '·¥∫')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥º'  onmousedown="document.execCommand('insertText', false, '·¥º')"  title='Superscript Capital'>
        <input type='button' class='button' value='·¥æ'  onmousedown="document.execCommand('insertText', false, '·¥æ')"  title='Superscript Capital'>&thinsp;
        <input type='button' class='button' value='·¥ø'  onmousedown="document.execCommand('insertText', false, '·¥ø')"  title='Superscript Capital'>&thinsp;
        <input type='button' class='button' value='·µÄ'  onmousedown="document.execCommand('insertText', false, '·µÄ')"  title='Superscript Capital'>
        <input type='button' class='button' value='·µÅ'  onmousedown="document.execCommand('insertText', false, '·µÅ')"  title='Superscript Capital'>
        <input type='button' class='button' value='‚±Ω'  onmousedown="document.execCommand('insertText', false, '‚±Ω')"  title='Superscript Capital'>
        <input type='button' class='button' value='·µÇ'  onmousedown="document.execCommand('insertText', false, '·µÇ')"  title='Superscript Capital'>
        <br>
        <input type='button' class='button' value='·µÉ'  onmousedown="document.execCommand('insertText', false, '·µÉ')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µá'  onmousedown="document.execCommand('insertText', false, '·µá')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·∂ú'  onmousedown="document.execCommand('insertText', false, '·∂ú')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µà'  onmousedown="document.execCommand('insertText', false, '·µà')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µâ'  onmousedown="document.execCommand('insertText', false, '·µâ')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·∂†'  onmousedown="document.execCommand('insertText', false, '·∂†')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µç'  onmousedown="document.execCommand('insertText', false, '·µç')"  title='Superscript Minuscule'>
        <input type='button' class='button' value=' ∞'  onmousedown="document.execCommand('insertText', false, ' ∞')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='‚Å±'  onmousedown="document.execCommand('insertText', false, '‚Å±')"  title='Superscript Minuscule'>
        <input type='button' class='button' value=' ≤'  onmousedown="document.execCommand('insertText', false, ' ≤')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µè'  onmousedown="document.execCommand('insertText', false, '·µè')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='À°'  onmousedown="document.execCommand('insertText', false, 'À°')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µê'  onmousedown="document.execCommand('insertText', false, '·µê')"  title='Superscript Minuscule'> 
        <input type='button' class='button' value='‚Åø'  onmousedown="document.execCommand('insertText', false, '‚Åø')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µí'  onmousedown="document.execCommand('insertText', false, '·µí')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µñ'  onmousedown="document.execCommand('insertText', false, '·µñ')"  title='Superscript Minuscule'>
        <input type='button' class='button' value=' ≥'  onmousedown="document.execCommand('insertText', false, ' ≥')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='À¢'  onmousedown="document.execCommand('insertText', false, 'À¢')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µó'  onmousedown="document.execCommand('insertText', false, '·µó')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µò'  onmousedown="document.execCommand('insertText', false, '·µò')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·µõ'  onmousedown="document.execCommand('insertText', false, '·µõ')"  title='Superscript Minuscule'>
        <input type='button' class='button' value=' ∑'  onmousedown="document.execCommand('insertText', false, ' ∑')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='À£'  onmousedown="document.execCommand('insertText', false, 'À£')"  title='Superscript Minuscule'>
        <input type='button' class='button' value=' ∏'  onmousedown="document.execCommand('insertText', false, ' ∏')"  title='Superscript Minuscule'>
        <input type='button' class='button' value='·∂ª'  onmousedown="document.execCommand('insertText', false, '·∂ª')"  title='Superscript Minuscule'>
        <br>
        <input type='button' class='button' value='‚Çê'  onmousedown="document.execCommand('insertText', false, '‚Çê')"  title='Subscript Minuscule'>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <input type='button' class='button' value='‚Çë'  onmousedown="document.execCommand('insertText', false, '‚Çë')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çî'  onmousedown="document.execCommand('insertText', false, '‚Çî')"  title='Subscript Minuscule'>
        &nbsp;&nbsp;&thinsp;
        <input type='button' class='button' value='‚Çï'  onmousedown="document.execCommand('insertText', false, '‚Çï')"   title='Subscript Minuscule'>
        <input type='button' class='button' value='·µ¢'  onmousedown="document.execCommand('insertText', false, '·µ¢')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='‚±º'  onmousedown="document.execCommand('insertText', false, '‚±º')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çñ'  onmousedown="document.execCommand('insertText', false, '‚Çñ')"   title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çó'  onmousedown="document.execCommand('insertText', false, '‚Çó')"   title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çò'  onmousedown="document.execCommand('insertText', false, '‚Çò')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çô'  onmousedown="document.execCommand('insertText', false, '‚Çô')"   title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çí'  onmousedown="document.execCommand('insertText', false, '‚Çí')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çö'  onmousedown="document.execCommand('insertText', false, '‚Çö')"   title='Subscript Minuscule'>
        <input type='button' class='button' value='·µ£'  onmousedown="document.execCommand('insertText', false, '·µ£')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çõ'  onmousedown="document.execCommand('insertText', false, '‚Çõ')"   title='Subscript Minuscule'>
        <input type='button' class='button' value='‚Çú'  onmousedown="document.execCommand('insertText', false, '‚Çú')"   title='Subscript Minuscule'>     
        <input type='button' class='button' value='·µ§'  onmousedown="document.execCommand('insertText', false, '·µ§')"  title='Subscript Minuscule'>
        <input type='button' class='button' value='·µ•'  onmousedown="document.execCommand('insertText', false, '·µ•')"  title='Subscript Minuscule'>
        &nbsp;&thinsp;
        <input type='button' class='button' value='‚Çì'  onmousedown="document.execCommand('insertText', false, '‚Çì')"  title='Subscript Minuscule'>
        <br>
        <input type='button' class='button' value='‚óÄ'  onmousedown="document.execCommand('insertText', false, '‚óÄ')" title='Backward triangle'>
        <input type='button' class='button' value='‚ñ≤'  onmousedown="document.execCommand('insertText', false, '‚ñ≤')"  title='up triangle'>
        <input type='button' class='button' value='‚ñº'  onmousedown="document.execCommand('insertText', false, '‚ñº')"  title='down triangle'>
        <input type='button' class='button' value='‚ñ∂'  onmousedown="document.execCommand('insertText', false, '‚ñ∂')" title='Forward triangle'>
        <input type='button' class='button' value='‚óÅ'  onmousedown="document.execCommand('insertText', false, '‚óÅ')" title='Backward triangle'>
        <input type='button' class='button' value='‚ñ≥'  onmousedown="document.execCommand('insertText', false, '‚ñ≥')" title='up triangle'>
        <input type='button' class='button' value='‚ñΩ'  onmousedown="document.execCommand('insertText', false, '‚ñΩ')" title='down triangle'>
        <input type='button' class='button' value='‚ñ∑'  onmousedown="document.execCommand('insertText', false, '‚ñ∑')" title='Forward triangle'>
        <br>
        <input type='button' class='button' value='‚¨Ö'  onmousedown="document.execCommand('insertText', false, '‚¨Ö')">
        <input type='button' class='button' value='‚¨å'  onmousedown="document.execCommand('insertText', false, '‚¨å')">
        <input type='button' class='button' value='‚ûû'  onmousedown="document.execCommand('insertText', false, '‚ûû')">
        <input type='button' class='button' value='‚¨Ü'  onmousedown="document.execCommand('insertText', false, '‚¨Ü')">
        <input type='button' class='button' value='‚¨ç'  onmousedown="document.execCommand('insertText', false, '‚¨ç')">
        <input type='button' class='button' value='‚¨á'  onmousedown="document.execCommand('insertText', false, '‚¨á')">
        <input type='button' class='button' value='‚¨à'  onmousedown="document.execCommand('insertText', false, '‚¨à')">
        <input type='button' class='button' value='‚¨â'  onmousedown="document.execCommand('insertText', false, '‚¨â')">
        <input type='button' class='button' value='‚¨ä'  onmousedown="document.execCommand('insertText', false, '‚¨ä')">
        <input type='button' class='button' value='‚¨ã'  onmousedown="document.execCommand('insertText', false, '‚¨ã')"> 
        <br>
        <input type='button' class='button' value='‚óª'  onmousedown="document.execCommand('insertText', false, '‚óª')" title='BLACK SQUARE'>
        <input type='button' class='button' value='‚óº'  onmousedown="document.execCommand('insertText', false, '‚óº')" title='WHITE SQUARE'>
        <input type='button' class='button' value='‚ñ¢'  onmousedown="document.execCommand('insertText', false, '‚ñ¢')">
        <input type='button' class='button' value='‚ñ£'  onmousedown="document.execCommand('insertText', false, '‚ñ£')">
        <input type='button' class='button' value='‚ñ§'  onmousedown="document.execCommand('insertText', false, '‚ñ§')">
        <input type='button' class='button' value='‚ñ•'  onmousedown="document.execCommand('insertText', false, '‚ñ•')">
        <input type='button' class='button' value='‚ñ¶'  onmousedown="document.execCommand('insertText', false, '‚ñ¶')">
        <input type='button' class='button' value='‚ñß'  onmousedown="document.execCommand('insertText', false, '‚ñß')">
        <input type='button' class='button' value='‚ñ®'  onmousedown="document.execCommand('insertText', false, '‚ñ®')">
        <input type='button' class='button' value='‚ñ©'  onmousedown="document.execCommand('insertText', false, '‚ñ©')">
        <br>
        <input type='button' class='button' value='‚óÜ'  onmousedown="document.execCommand('insertText', false, '‚óÜ')" title='BLACK DIAMOND'>
        <input type='button' class='button' value='‚óá'  onmousedown="document.execCommand('insertText', false, '‚óá')" title='WHITE DIAMOND'>
        <input type='button' class='button' value='‚¨§'  onmousedown="document.execCommand('insertText', false, '‚¨§')" title='BLACK CIRCLE'>
        <input type='button' class='button' value='‚≠ò'  onmousedown="document.execCommand('insertText', false, '‚≠ò')" title='WHITE CIRCLE'>
        <input type='button' class='button' value='‚óç'  onmousedown="document.execCommand('insertText', false, '‚óç')">
        &nbsp;
        <input type='button' class='button' value='‚ãÆ'  onmousedown="document.execCommand('insertText', false, '‚ãÆ')"   title='Vertical Ellipses'>
        <input type='button' class='button' value='‚Ä†'  onmousedown="document.execCommand('insertText', false, '‚Ä†')"   title='Dagger'>
      </div>
    </div>
    <input type='button' class='button' value='ùóï'  onmousedown="document.execCommand('bold', false, null)"             title='Ctrl+B' style="padding-top:2px;">
    <input type='button' class='button' value='ùë∞'  onmousedown="document.execCommand('italic', false, null)"           title='Ctrl+I' style="padding-top:2px;">
    <input type='button' class='button' value='ùêí'  onmousedown="document.execCommand('strikeThrough', false, null)" style='text-decoration: line-through;padding-top:2px;'>
    <input type='button' class='button' value='ùëø‚ÇÇ' onmousedown="document.execCommand('subscript', false, null)"                       style="padding-top:2px;">
    <input type='button' class='button' value='ùëø¬≤' onmousedown="document.execCommand('superscript', false, null)"                     style="padding-top:2px;">
    <input type='button' class='button' value='ùü≠.' onmousedown="document.execCommand('insertOrderedList', false, null)"               style="padding-top:2px;">
    <input type='button' class='button' value='‚âî' onmousedown="document.execCommand('insertUnorderedList', false, null)"             style="padding-top:2px;">
    <input type='button' class='button' value='‚ùå' onmousedown="document.execCommand('removeFormat', false, null)"     title='Remove Format'>
    <input type='button' class='button' value='üîÑ' onmousedown="loadValue(CleanTextElem)"                              title='Load'>
    <input type='button' class='button' value='üíæ' onmousedown="saveValue(CleanTextElem)"                              title='Save'>
    <!--<input type='button' class='button' value='p'  onmousedown="prompt('',CleanTextElem.innerHTML)"                    title='prompt'>-->
    <br>
    <div id="CleanText" contenteditable="true" class="textCleanerDiv" spellcheck="true" data-enable-grammarly="true" data-gramm="true"></div>

    <script>
        var globalCellObj = {};
        var CleanTextElem = document.getElementById('CleanText');
        function removeUnwantedNodes(elem){
          //remove highlights
          while (mark = elem.querySelector('mark')) 
            mark.outerHTML = mark.innerHTML;
          //remove case-sensitive search tool highlights
          while (span = elem.querySelector('span')) 
            span.outerHTML = span.innerHTML;
          //convert <div> to <br>
          while (div = elem.querySelector('div')) 
            div.outerHTML = div.innerHTML+'<br>';
          //convert <p> to <br>
          while (p = elem.querySelector('p')) 
            p.outerHTML = p.innerHTML+'<br>';
          //add an end <br>
          elem.innerHTML =  elem.innerHTML.replace(/(?:<br>|\s)*$/g, '<br> ')//+'<br> ';//document.createElement("p").innerHTML = //.replace(/(?:<br>|\s)*$/g, '<br>')
          
          return elem;
        }
        function loadValue(elem){
          google.script.run
          .withSuccessHandler(function(cellObj){
            globalCellObj = cellObj;
            elem.innerHTML = '<p>'+(cellObj.cellValue)+'</p>';
            formatText(CleanTextElem);
            formatText(CleanTextElem);
            })
          .getActiveCell();
        }
        function saveValue(elem){
          formatText(elem);
          //remove highlights
          removeUnwantedNodes(elem);
          google.script.run
            .withFailureHandler(showSnackbar("<b style='color:lightsalmon'>failed to save</b>"))
            .withSuccessHandler(showSnackbar('saved successfully'))
            .setActiveCellValue(JSON.stringify(globalCellObj), 
              elem.innerHTML
              .replace(/^<!--td.*-->|(?:<br>|\s)+$/g, '')
              .replace(/(?:\<br\>)*\s*[\n\r]+\s*/g, '<br>')
              .replace(/(?:&nbsp;|[\s\r\n\x0A])+/g,' ')
              .replace(/^(?:<br>|&nbsp;|[\s\r\n\x0A])+|(?:<b>(?:&nbsp;|[\s\r\n\x0A])*<\/b>)+|(?:<br>|&nbsp;|[\s\r\n\x0A])+$/g,'')
              .replace(/(?:(?:\s|<[bi]>)*<br>(?:\s|<[bi]>)*){2,}/g,'<br>')
            )
            highlightElem(elem);
        }
        window.onload = function () {
          CleanTextElem = document.getElementById('CleanText');
          
          loadValue(CleanTextElem);
          
          CleanTextElem.addEventListener("paste", function(e) {try{
            // cancel paste
            e.preventDefault();
            
            //get html representation of clipboard if there is html if not get text
            var html = e.clipboardData.getData('text/html');
            if (html) {
              // a temporary element
              var divElem = document.createElement('div');
              divElem.innerHTML = html;
              Array.from(divElem.getElementsByTagName('span')).forEach(elem=>{
                if (elem.style.fontFeatureSettings==='smcp' || elem.style.fontVariantCaps==='small-caps' || elem.style.fontVariant==='small-caps')
                  elem.outerHTML = elem.innerText.toUpperCase();
              });
              if (divElem.hasChildNodes()) {
                var cElems = divElem.childNodes;
                for (i = cElems.length; i>-1; --i)
                  if (elem = cElems[i])
                    if (elem.style)
                      if (elem.style.fontFeatureSettings==='smcp' || elem.style.fontVariantCaps==='small-caps' || elem.style.fontVariant==='small-caps')
                        elem.outerHTML = elem.innerText.toUpperCase();
              }
              
              if (head = divElem.querySelector('thead')) 
                while (elem = head.querySelector("td"))
                  elem.outerHTML = '@th@'+elem.innerHTML+'@|th@';

              //convert sub, sup, b, strong, em, italic elems to sth html nutral
              ['p','div','sub','sup','b','ul','li','td','th','tr','thead','tbody','table'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@'+tag+'@'+elem.innerHTML+'@|'+tag+'@';
              });
              ['h1','h2','h3','h4','h5','h6'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@p@@b@'+elem.innerHTML+'@|b@@|p@';
              });
              ['strong'].forEach(function(tag){
                while (elem = divElem.querySelector(tag)) 
                  elem.outerHTML = '@b@'+elem.innerHTML+'@|b@';
              });
//              ['em','i'].forEach(function(tag){
//                while (elem = divElem.querySelector(tag)) 
//                  elem.outerHTML = (elem.innerHTML === 'n') ? elem.innerHTML : ('@i@'+elem.innerHTML+'@|i@');
//              });
              divElem.innerHTML = divElem.innerHTML.replace(/<br[^>]*?>/ig,'@br@');
              //prompt('',divElem.innerHTML);
              function atToHtml(txt) {
                var inlineElem = /(@(su[bp]|b|table|thead|th|tbody|tr|td|ul|li)@)(?!.*\1)(.*?)@\|\2@/g;
                var elemToBr = /(@(p|div)@)(?!.*\1)(.*?)@\|\2@/g;
                var br = /(?:\s*@br@\s*)+/g;
                txt = txt.replace(/&/g,'&amp;')
                         .replace(/</g,'&lt;')
                         .replace(/>/g,'&gt;')
                         .replace(/‚Äî/g,'&ndash;')
                         ;
                while(inlineElem.test(txt))
                 txt = txt.replace(inlineElem,'<$2>$3</$2>');
                while(elemToBr.test(txt))
                 txt = txt.replace(elemToBr,'$3<br>');
                while(br.test(txt))
                 txt = txt.replace(br,'<br>');
                txt = txt.replace(/^(?:<br>|[\s\n\r])+|(?:<br>|[\s\n\r])+$/g,'')
                          .replace(/(?:\s*<br>\s*)+/g,'<br>');
                return txt;
              }
              
              document.execCommand("insertHTML", false, atToHtml(divElem.innerText));
            } else {
              document.execCommand("insertHTML", false, e.clipboardData.getData('text/plain').replace(/^[\s\n\r]+|[\s\n\r]+$/g,''));
            }
          }catch(error){
            alert(error)
          }});
        }
    </script>
    <?!= include('shortcuts'); ?>
    <script>
    shortcut.add('Ctrl+.',function(){document.execCommand('superscript', false, null)});
    shortcut.add('Ctrl+,',function(){document.execCommand('subscript', false, null)});
    shortcut.add('Ctrl+m',function(){document.execCommand('insertText', false, '¬µ')});
    shortcut.add('Ctrl+f12',function(){document.execCommand('insertText', false, '‚Äì')});
    shortcut.add('enter',function(){document.execCommand('insertHTML', false, '<br>')});
    shortcut.add('f2',function(){saveValue(CleanTextElem)});
    </script>
    
    <?!= include('snackBar'); ?>
  </body>
</html>
